# ğŸš€ TEST_lifecycle æ¨¡å—è¯´æ˜æ–‡æ¡£

> **æ‰©å±•ç‰ˆç”Ÿå‘½å‘¨æœŸå»ºæ¨¡æ¡†æ¶**
> 
> æœ¬æ¨¡å—æ‰©å±•äº† ArkAnalyzer çš„ `DummyMainCreater`ï¼Œå®ç°å¤š Ability æ”¯æŒå’Œç²¾ç»†åŒ– UI å›è°ƒå»ºæ¨¡ã€‚æ–°çš„ä»£ç æš‚æ—¶æ”¾åœ¨äº†arkanalyzer-master\arkanalyzer-master\src\TEST_lifecycleç›®å½•ä¸‹

---

## ğŸ“š ç›®å½•

1. [èƒŒæ™¯ä¸åŠ¨æœº](#1-èƒŒæ™¯ä¸åŠ¨æœº)
2. [æ ¸å¿ƒæ¦‚å¿µ](#2-æ ¸å¿ƒæ¦‚å¿µ)
3. [æ¨¡å—æ¶æ„](#3-æ¨¡å—æ¶æ„)
4. [æ–‡ä»¶è¯¦è§£](#4-æ–‡ä»¶è¯¦è§£)
5. [å®Œæ•´æµç¨‹è§£æ](#5-å®Œæ•´æµç¨‹è§£æ)
6. [ç±»ä¸å‡½æ•°è¯¦è§£](#6-ç±»ä¸å‡½æ•°è¯¦è§£)
7. [ä½¿ç”¨ç¤ºä¾‹](#7-ä½¿ç”¨ç¤ºä¾‹)
8. [TODO ä¸æ‰©å±•ç‚¹](#8-todo-ä¸æ‰©å±•ç‚¹)
9. [å¸¸è§é—®é¢˜](#9-å¸¸è§é—®é¢˜)

---

## 1. èƒŒæ™¯ä¸åŠ¨æœº

### 1.1 ä¸ºä»€ä¹ˆéœ€è¦ DummyMainï¼Ÿ

åœ¨é¸¿è’™/Android åº”ç”¨ä¸­ï¼Œ**æ²¡æœ‰ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„ `main()` å‡½æ•°**ã€‚åº”ç”¨çš„æ‰§è¡Œç”±ç³»ç»Ÿæ¡†æ¶é©±åŠ¨ï¼š

```
ä¼ ç»Ÿç¨‹åº:
    main() â†’ å‡½æ•°A() â†’ å‡½æ•°B() â†’ ç»“æŸ

é¸¿è’™åº”ç”¨:
    ç³»ç»Ÿå¯åŠ¨ â†’ onCreate() â†’ onForeground() â†’ ç”¨æˆ·ç‚¹å‡»æŒ‰é’® â†’ onClick() â†’ ...
    ï¼ˆç”±ç³»ç»Ÿåœ¨ä¸åŒæ—¶æœºè°ƒç”¨ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼‰
```

**é—®é¢˜**ï¼šé™æ€åˆ†æå·¥å…·éœ€è¦ä¸€ä¸ªå…¥å£ç‚¹æ¥éå†ä»£ç ï¼Œä½†é¸¿è’™åº”ç”¨æ²¡æœ‰ï¼

**è§£å†³æ–¹æ¡ˆ**ï¼šåˆ›å»ºä¸€ä¸ª**è™šæ‹Ÿçš„ main å‡½æ•°ï¼ˆDummyMainï¼‰**ï¼ŒæŠŠæ‰€æœ‰å¯èƒ½è¢«è°ƒç”¨çš„æ–¹æ³•ä¸²è”èµ·æ¥ã€‚

### 1.2 åŸç‰ˆ DummyMainCreater çš„å±€é™

| å±€é™ | è¯´æ˜ |
|------|------|
| **å• Ability** | åªå¤„ç†å•ä¸ª Sceneï¼Œä¸æ”¯æŒå¤šé¡µé¢åº”ç”¨ |
| **æ— è·³è½¬å»ºæ¨¡** | å¿½ç•¥ `startAbility()`ã€`router.pushUrl()` ç­‰è·³è½¬ |
| **ç²—ç³™çš„å›è°ƒæ”¶é›†** | ç›´æ¥æ”¶é›†æ‰€æœ‰ `onClick` æ–¹æ³•ï¼Œä¸åŒºåˆ†å±äºå“ªä¸ªæ§ä»¶ |
| **æœªåˆ©ç”¨ ViewTree** | æ²¡æœ‰ä½¿ç”¨å·²æœ‰çš„ UI æ ‘è§£æèƒ½åŠ› |

### 1.3 æœ¬æ¨¡å—çš„ç›®æ ‡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ‰©å±•ç‰ˆ DummyMain                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… æ”¯æŒå¤šä¸ª Ability                                         â”‚
â”‚  âœ… å»ºæ¨¡é¡µé¢è·³è½¬å…³ç³»ï¼ˆæ¡†æ¶å·²æœ‰ï¼Œå¾…å®ç°ï¼‰                        â”‚
â”‚  âœ… ç²¾ç»†åŒ– UI å›è°ƒï¼ˆæŒ‰æ§ä»¶æå–ï¼‰                              â”‚
â”‚  âœ… æ•´åˆ ViewTree è§£æ                                       â”‚
â”‚  âœ… æ¨¡å—åŒ–ã€å¯é…ç½®                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. æ ¸å¿ƒæ¦‚å¿µ

### 2.1 ä»€ä¹ˆæ˜¯ Abilityï¼Ÿ

**Ability** æ˜¯é¸¿è’™åº”ç”¨çš„åŸºæœ¬ç»„æˆå•å…ƒï¼Œç±»ä¼¼äº Android çš„ Activityã€‚

```typescript
// ä¸€ä¸ªå…¸å‹çš„ Ability
export default class EntryAbility extends UIAbility {
    onCreate(want: Want) { /* åˆ›å»ºæ—¶è°ƒç”¨ */ }
    onWindowStageCreate(windowStage: WindowStage) { /* çª—å£åˆ›å»º */ }
    onForeground() { /* è¿›å…¥å‰å° */ }
    onBackground() { /* è¿›å…¥åå° */ }
    onDestroy() { /* é”€æ¯æ—¶è°ƒç”¨ */ }
}
```

**ç”Ÿå‘½å‘¨æœŸæµç¨‹**ï¼š

```mermaid
stateDiagram-v2
    [*] --> onCreate: å¯åŠ¨åº”ç”¨
    onCreate --> onWindowStageCreate: åˆ›å»ºçª—å£
    onWindowStageCreate --> onForeground: æ˜¾ç¤ºç•Œé¢
    onForeground --> onBackground: åˆ‡åˆ°åå°
    onBackground --> onForeground: å›åˆ°å‰å°
    onBackground --> onWindowStageDestroy: å‡†å¤‡é”€æ¯
    onWindowStageDestroy --> onDestroy: é”€æ¯
    onDestroy --> [*]
```

### 2.2 ä»€ä¹ˆæ˜¯ Componentï¼Ÿ

**Component** æ˜¯é¸¿è’™çš„ UI ç»„ä»¶ï¼Œç”¨ `@Component` è£…é¥°å™¨æ ‡è®°ã€‚

```typescript
@Entry
@Component
struct Index {
    @State message: string = 'Hello';
    
    aboutToAppear() { /* ç»„ä»¶å³å°†æ˜¾ç¤º */ }
    
    build() {
        Column() {
            Text(this.message)
            Button('Click me')
                .onClick(() => {
                    this.message = 'Clicked!';  // è¿™å°±æ˜¯ UI å›è°ƒ
                })
        }
    }
    
    aboutToDisappear() { /* ç»„ä»¶å³å°†æ¶ˆå¤± */ }
}
```

### 2.3 ä»€ä¹ˆæ˜¯ ViewTreeï¼Ÿ

**ViewTree** æ˜¯ ArkAnalyzer è§£æ `build()` æ–¹æ³•åå¾—åˆ°çš„ UI ç»„ä»¶æ ‘ã€‚

```
æºä»£ç :                          ViewTree:
Column() {                       Column
    Text('Hello')         â†’        â”œâ”€â”€ Text
    Button('Click')                â”‚     â””â”€â”€ attributes: []
        .onClick(...)              â””â”€â”€ Button
}                                        â””â”€â”€ attributes: [onClick]
```

### 2.4 ç”Ÿæˆçš„ DummyMain é•¿ä»€ä¹ˆæ ·ï¼Ÿ

```typescript
function @extendedDummyMain() {
    // 1. é™æ€åˆå§‹åŒ–
    StaticClass.staticInit();
    
    // 2. ä¸»å¾ªç¯ï¼ˆæ¨¡æ‹Ÿéç¡®å®šæ€§æ‰§è¡Œï¼‰
    count = 0;
    while (true) {
        // åˆ†æ”¯ 1: EntryAbility ç”Ÿå‘½å‘¨æœŸ
        if (count == 1) {
            ability1 = new EntryAbility();
            ability1.onCreate(want);
            ability1.onWindowStageCreate(windowStage);
            ability1.onForeground();
        }
        
        // åˆ†æ”¯ 2: Index ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ + UI å›è°ƒ
        if (count == 2) {
            component1 = new Index();
            component1.aboutToAppear();
            component1.build();
            
            // ç²¾ç»†åŒ– UI å›è°ƒ
            component1.onClick_handler();  // Button çš„ç‚¹å‡»å›è°ƒ
        }
        
        // åˆ†æ”¯ 3: å¦ä¸€ä¸ª Ability...
        if (count == 3) {
            ability2 = new SecondAbility();
            // ...
        }
    }
    return;
}
```

---

## 3. æ¨¡å—æ¶æ„

### 3.1 æ–‡ä»¶ç»“æ„

```
TEST_lifecycle/
â”‚
â”œâ”€â”€ ğŸ“„ index.ts                      # æ¨¡å—å…¥å£ï¼Œç»Ÿä¸€å¯¼å‡º
â”‚
â”œâ”€â”€ ğŸ“„ LifecycleTypes.ts             # ç±»å‹å®šä¹‰
â”‚   â”‚   å®šä¹‰æ‰€æœ‰æ•°æ®ç»“æ„ï¼Œä¸åŒ…å«é€»è¾‘
â”‚   â”‚
â”‚   â”œâ”€â”€ AbilityLifecycleStage        # Ability ç”Ÿå‘½å‘¨æœŸæšä¸¾
â”‚   â”œâ”€â”€ ComponentLifecycleStage      # Component ç”Ÿå‘½å‘¨æœŸæšä¸¾
â”‚   â”œâ”€â”€ AbilityInfo                  # Ability ä¿¡æ¯ç»“æ„
â”‚   â”œâ”€â”€ ComponentInfo                # Component ä¿¡æ¯ç»“æ„
â”‚   â”œâ”€â”€ UICallbackInfo               # UI å›è°ƒä¿¡æ¯ç»“æ„
â”‚   â””â”€â”€ LifecycleModelConfig         # é…ç½®é€‰é¡¹
â”‚
â”œâ”€â”€ ğŸ“„ AbilityCollector.ts           # ä¿¡æ¯æ”¶é›†å™¨
â”‚   â”‚   è´Ÿè´£ä» Scene ä¸­æ”¶é›† Ability å’Œ Component
â”‚   â”‚
â”‚   â”œâ”€â”€ collectAllAbilities()        # æ”¶é›†æ‰€æœ‰ Ability
â”‚   â”œâ”€â”€ collectAllComponents()       # æ”¶é›†æ‰€æœ‰ Component
â”‚   â””â”€â”€ analyzeNavigationTargets()   # åˆ†æè·³è½¬å…³ç³» âœ…
â”‚
â”œâ”€â”€ ğŸ“„ NavigationAnalyzer.ts         # ğŸ†• è·¯ç”±åˆ†æå™¨
â”‚   â”‚   åˆ†æä»£ç ä¸­çš„é¡µé¢è·³è½¬å…³ç³»
â”‚   â”‚
â”‚   â”œâ”€â”€ analyzeClass()               # åˆ†æä¸€ä¸ªç±»çš„æ‰€æœ‰è·¯ç”±
â”‚   â”œâ”€â”€ handleLoadContent()          # å¤„ç† windowStage.loadContent
â”‚   â”œâ”€â”€ handleRouterPush()           # å¤„ç† router.pushUrl
â”‚   â”œâ”€â”€ handleRouterReplace()        # å¤„ç† router.replaceUrl
â”‚   â””â”€â”€ handleStartAbility()         # å¤„ç† startAbility
â”‚
â”œâ”€â”€ ğŸ“„ ViewTreeCallbackExtractor.ts  # å›è°ƒæå–å™¨
â”‚   â”‚   ä» ViewTree ä¸­ç²¾ç»†åŒ–æå– UI å›è°ƒ
â”‚   â”‚
â”‚   â”œâ”€â”€ extractFromComponent()       # æå–å•ä¸ªç»„ä»¶çš„å›è°ƒ
â”‚   â””â”€â”€ fillAllComponentCallbacks()  # æ‰¹é‡å¡«å……
â”‚
â””â”€â”€ ğŸ“„ LifecycleModelCreator.ts      # æ ¸å¿ƒæ„å»ºå™¨
    â”‚   ç»„è£…æ‰€æœ‰éƒ¨ä»¶ï¼Œç”Ÿæˆæœ€ç»ˆçš„ DummyMain
    â”‚
    â”œâ”€â”€ create()                     # ä¸»å…¥å£
    â”œâ”€â”€ collectAbilitiesAndComponents()
    â”œâ”€â”€ extractUICallbacks()
    â”œâ”€â”€ createDummyMainContainer()
    â””â”€â”€ buildDummyMainCfg()
```

### 3.2 æ¨¡å—ä¾èµ–å…³ç³»

```mermaid
graph TD
    subgraph "TEST_lifecycle æ¨¡å—"
        A[LifecycleModelCreator<br/>æ ¸å¿ƒæ„å»ºå™¨]
        B[AbilityCollector<br/>ä¿¡æ¯æ”¶é›†]
        C[ViewTreeCallbackExtractor<br/>å›è°ƒæå–]
        D[LifecycleTypes<br/>ç±»å‹å®šä¹‰]
    end
    
    subgraph "ArkAnalyzer æ ¸å¿ƒ"
        E[Scene]
        F[ArkClass / ArkMethod]
        G[ViewTree]
        H[Cfg / BasicBlock]
    end
    
    A --> B
    A --> C
    A --> D
    B --> D
    C --> D
    
    B --> E
    B --> F
    C --> G
    A --> H
    
    style A fill:#e1f5fe
    style D fill:#fff3e0
```

### 3.3 æ•°æ®æµå‘

```mermaid
flowchart LR
    subgraph è¾“å…¥
        S["Scene<br/>æ•´ä¸ªé¡¹ç›®çš„ä»£ç æ¨¡å‹"]
    end
    
    subgraph å¤„ç†
        A[æ”¶é›† Ability] --> D["AbilityInfo[]"]
        B[æ”¶é›† Component] --> E["ComponentInfo[]"]
        C[æå– ViewTree å›è°ƒ] --> F["UICallbackInfo[]"]
    end
    
    subgraph è¾“å‡º
        G["@extendedDummyMain<br/>è™šæ‹Ÿå…¥å£æ–¹æ³•"]
    end
    
    S --> A
    S --> B
    E --> C
    
    D --> G
    E --> G
    F --> G
```

---

## 4. æ–‡ä»¶è¯¦è§£

### 4.1 LifecycleTypes.ts â€” ç±»å‹å®šä¹‰

**è§’è‰²**ï¼šæ•°æ®ç»“æ„çš„"è“å›¾"ï¼Œå®šä¹‰äº†æ‰€æœ‰ä¿¡æ¯çš„æ ¼å¼ã€‚

**ç±»æ¯”**ï¼šå°±åƒå»ºç­‘å›¾çº¸ï¼Œè§„å®šäº†æ¯ä¸ªæˆ¿é—´çš„å°ºå¯¸å’Œç”¨é€”ï¼Œä½†ä¸åŒ…å«å®é™…çš„ç –å—ã€‚

#### ä¸»è¦ç±»å‹

```typescript
// ==================== ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ ====================

/**
 * Ability ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ
 * 
 * æƒ³è±¡æˆä¸€ä¸ªäººçš„ä¸€å¤©ï¼š
 * - CREATE      = èµ·åºŠ
 * - FOREGROUND  = å¼€å§‹å·¥ä½œ
 * - BACKGROUND  = ä¼‘æ¯
 * - DESTROY     = ç¡è§‰
 */
enum AbilityLifecycleStage {
    CREATE = 'onCreate',
    WINDOW_STAGE_CREATE = 'onWindowStageCreate',
    FOREGROUND = 'onForeground',
    BACKGROUND = 'onBackground',
    WINDOW_STAGE_DESTROY = 'onWindowStageDestroy',
    DESTROY = 'onDestroy',
}

// ==================== ä¿¡æ¯ç»“æ„ ====================

/**
 * Ability ä¿¡æ¯
 * 
 * å­˜å‚¨ä¸€ä¸ª Ability çš„"èº«ä»½è¯"
 */
interface AbilityInfo {
    arkClass: ArkClass;                    // å¯¹åº”çš„ç±»
    name: string;                          // åç§°
    lifecycleMethods: Map<Stage, Method>;  // ç”Ÿå‘½å‘¨æœŸæ–¹æ³•
    components: ComponentInfo[];           // å…³è”çš„ç»„ä»¶
    navigationTargets: NavigationTarget[]; // å¯è·³è½¬çš„ç›®æ ‡
    isEntry: boolean;                      // æ˜¯å¦æ˜¯å…¥å£
}

/**
 * UI å›è°ƒä¿¡æ¯
 * 
 * è®°å½•"å“ªä¸ªæ§ä»¶çš„ä»€ä¹ˆäº‹ä»¶ç»‘å®šäº†å“ªä¸ªå‡½æ•°"
 */
interface UICallbackInfo {
    componentType: string;      // æ§ä»¶ç±»å‹ï¼šButton, Text...
    eventType: UIEventType;     // äº‹ä»¶ç±»å‹ï¼šonClick, onTouch...
    callbackMethod: ArkMethod;  // å›è°ƒæ–¹æ³•
    relatedStateValues: [];     // ç›¸å…³çš„çŠ¶æ€å˜é‡
}
```

---

### 4.2 AbilityCollector.ts â€” ä¿¡æ¯æ”¶é›†å™¨

**è§’è‰²**ï¼šé¡¹ç›®çš„"æ™®æŸ¥å‘˜"ï¼Œéå†æ‰€æœ‰ä»£ç ï¼Œæ‰¾å‡º Ability å’Œ Componentã€‚

**ç±»æ¯”**ï¼šå°±åƒäººå£æ™®æŸ¥å‘˜æŒ¨å®¶æŒ¨æˆ·ç™»è®°ä¿¡æ¯ã€‚

#### æ ¸å¿ƒæ–¹æ³•

```typescript
class AbilityCollector {
    /**
     * æ”¶é›†æ‰€æœ‰ Ability
     * 
     * å·¥ä½œæµç¨‹ï¼š
     * 1. éå† Scene ä¸­çš„æ‰€æœ‰ç±»
     * 2. åˆ¤æ–­æ¯ä¸ªç±»æ˜¯å¦ç»§æ‰¿è‡ª UIAbility
     * 3. å¦‚æœæ˜¯ï¼Œæå–å®ƒçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•
     * 4. è¿”å› AbilityInfo åˆ—è¡¨
     */
    collectAllAbilities(): AbilityInfo[] {
        for (class of scene.getClasses()) {
            if (isAbilityClass(class)) {
                // è¿™ä¸ªç±»æ˜¯ Abilityï¼
                info = buildAbilityInfo(class);
                abilities.push(info);
            }
        }
        return abilities;
    }
    
    /**
     * åˆ¤æ–­æ˜¯å¦æ˜¯ Ability ç±»
     * 
     * åˆ¤æ–­ä¾æ®ï¼š
     * - ç›´æ¥ç»§æ‰¿ UIAbility / Ability / ...
     * - æˆ–è€…ç¥–å…ˆç±»ç»§æ‰¿äº†è¿™äº›åŸºç±»
     */
    private isAbilityClass(arkClass): boolean {
        // æ£€æŸ¥çˆ¶ç±»åç§°
        if (['UIAbility', 'Ability'].includes(arkClass.getSuperClassName())) {
            return true;
        }
        // æ£€æŸ¥ç»§æ‰¿é“¾...
    }
    
    /**
     * æ”¶é›†ç”Ÿå‘½å‘¨æœŸæ–¹æ³•
     * 
     * éå†ç±»çš„æ‰€æœ‰æ–¹æ³•ï¼Œæ‰¾å‡º onCreate, onDestroy ç­‰
     */
    private collectAbilityLifecycleMethods(arkClass): Map<Stage, Method> {
        for (method of arkClass.getMethods()) {
            switch (method.getName()) {
                case 'onCreate':
                    methods.set(CREATE, method);
                    break;
                case 'onDestroy':
                    methods.set(DESTROY, method);
                    break;
                // ...
            }
        }
    }
}
```

#### å·¥ä½œåŸç†å›¾

```mermaid
flowchart TD
    A[Scene.getClasses] --> B{éå†æ¯ä¸ªç±»}
    B --> C{æ˜¯å¦ç»§æ‰¿ UIAbility?}
    C -->|æ˜¯| D[æå–ç”Ÿå‘½å‘¨æœŸæ–¹æ³•]
    C -->|å¦| E{æ˜¯å¦æœ‰ @Component?}
    E -->|æ˜¯| F[æå–ç»„ä»¶ä¿¡æ¯]
    E -->|å¦| B
    D --> G[æ·»åŠ åˆ° abilities åˆ—è¡¨]
    F --> H[æ·»åŠ åˆ° components åˆ—è¡¨]
    G --> B
    H --> B
    B -->|éå†å®Œæˆ| I[è¿”å›ç»“æœ]
```

---

### 4.3 NavigationAnalyzer.ts â€” è·¯ç”±åˆ†æå™¨ ğŸ†•

**è§’è‰²**ï¼šé¡µé¢è·³è½¬çš„"è¿½è¸ªè€…"ï¼Œåˆ†æä»£ç ä¸­æ‰€æœ‰çš„è·¯ç”±/å¯¼èˆªè°ƒç”¨ã€‚

**ç±»æ¯”**ï¼šå°±åƒäº¤é€šè°ƒåº¦å‘˜ï¼Œè¿½è¸ªæ‰€æœ‰è½¦è¾†ï¼ˆé¡µé¢ï¼‰çš„è¡Œé©¶è·¯çº¿ï¼ˆè·³è½¬å…³ç³»ï¼‰ã€‚

#### ä»€ä¹ˆæ˜¯è·¯ç”±åˆ†æï¼Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         è·¯ç”±åˆ†æå›¾è§£                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  æºä»£ç ä¸­çš„è·³è½¬è°ƒç”¨:                                              â”‚
â”‚                                                                 â”‚
â”‚  // 1. Ability åŠ è½½åˆå§‹é¡µé¢                                      â”‚
â”‚  windowStage.loadContent('pages/Index')                         â”‚
â”‚                     â†“                                           â”‚
â”‚  // 2. é¡µé¢é—´è·³è½¬                                                â”‚
â”‚  router.pushUrl({ url: 'pages/Detail' })                        â”‚
â”‚                     â†“                                           â”‚
â”‚  // 3. Ability é—´è·³è½¬                                           â”‚
â”‚  context.startAbility({ abilityName: 'SecondAbility' })         â”‚
â”‚                                                                 â”‚
â”‚                     â†“â†“â†“                                         â”‚
â”‚                                                                 â”‚
â”‚  è·¯ç”±åˆ†æå™¨æå–å‡º:                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  NavigationTarget[] = [                 â”‚                   â”‚
â”‚  â”‚    { target: 'pages/Index',             â”‚                   â”‚
â”‚  â”‚      type: LOAD_CONTENT },              â”‚                   â”‚
â”‚  â”‚    { target: 'pages/Detail',            â”‚                   â”‚
â”‚  â”‚      type: ROUTER_PUSH },               â”‚                   â”‚
â”‚  â”‚    { target: 'SecondAbility',           â”‚                   â”‚
â”‚  â”‚      type: START_ABILITY }              â”‚                   â”‚
â”‚  â”‚  ]                                      â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ”¯æŒçš„è·³è½¬æ–¹å¼

| æ–¹æ³• | ç”¨é€” | ç¤ºä¾‹ |
|------|------|------|
| `loadContent` | Ability åŠ è½½åˆå§‹é¡µé¢ | `windowStage.loadContent('pages/Index')` |
| `pushUrl` | é¡µé¢è·³è½¬ï¼ˆå¯è¿”å›ï¼‰ | `router.pushUrl({ url: 'pages/Detail' })` |
| `replaceUrl` | é¡µé¢æ›¿æ¢ï¼ˆä¸å¯è¿”å›ï¼‰ | `router.replaceUrl({ url: 'pages/Login' })` |
| `back` | è¿”å›ä¸Šä¸€é¡µ | `router.back()` |
| `startAbility` | å¯åŠ¨æ–° Ability | `context.startAbility(want)` |

#### å·¥ä½œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NavigationAnalyzer å·¥ä½œæµç¨‹                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  è¾“å…¥: ArkClass (Ability æˆ– Component)                          â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  for (method of class.getMethods()) {               â”‚       â”‚
â”‚  â”‚      for (block of method.getCfg().getBlocks()) {   â”‚       â”‚
â”‚  â”‚          for (stmt of block.getStmts()) {           â”‚       â”‚
â”‚  â”‚              invokeExpr = stmt.getInvokeExpr();     â”‚       â”‚
â”‚  â”‚              if (invokeExpr) {                      â”‚       â”‚
â”‚  â”‚                  methodName = getMethodName();      â”‚       â”‚
â”‚  â”‚                  switch (methodName) {              â”‚       â”‚
â”‚  â”‚                      case 'loadContent': ...        â”‚       â”‚
â”‚  â”‚                      case 'pushUrl': ...            â”‚       â”‚
â”‚  â”‚                      case 'startAbility': ...       â”‚       â”‚
â”‚  â”‚                  }                                  â”‚       â”‚
â”‚  â”‚              }                                      â”‚       â”‚
â”‚  â”‚          }                                          â”‚       â”‚
â”‚  â”‚      }                                              â”‚       â”‚
â”‚  â”‚  }                                                  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  è¾“å‡º: NavigationAnalysisResult {                               â”‚
â”‚      initialPage: 'pages/Index',                               â”‚
â”‚      navigationTargets: [...],                                 â”‚
â”‚      warnings: [...]                                           â”‚
â”‚  }                                                              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ä½¿ç”¨ç¤ºä¾‹

```typescript
import { NavigationAnalyzer } from './NavigationAnalyzer';

const analyzer = new NavigationAnalyzer(scene);

// åˆ†æä¸€ä¸ª Ability
const result = analyzer.analyzeClass(entryAbilityClass);

console.log('åˆå§‹é¡µé¢:', result.initialPage);
// è¾“å‡º: åˆå§‹é¡µé¢: pages/Index

console.log('è·³è½¬ç›®æ ‡:');
for (const target of result.navigationTargets) {
    console.log(`  ${target.navigationType}: ${target.targetAbilityName}`);
}
// è¾“å‡º:
//   ROUTER_PUSH: pages/Index
//   ROUTER_PUSH: pages/Detail
```

#### å‚æ•°è§£æç¤ºæ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å‚æ•°è§£æè¿‡ç¨‹                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  æƒ…å†µ 1: ç›´æ¥å­—ç¬¦ä¸²ï¼ˆå¯è§£æ âœ…ï¼‰                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  windowStage.loadContent('pages/Index')  â”‚                   â”‚
â”‚  â”‚                          â†‘               â”‚                   â”‚
â”‚  â”‚                    Constant ç±»å‹         â”‚                   â”‚
â”‚  â”‚                    ç›´æ¥æå– getValue()   â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                 â”‚
â”‚  æƒ…å†µ 2: å˜é‡å¼•ç”¨ï¼ˆå·²å®ç° âœ…ï¼‰                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  let options = { url: 'pages/Detail' };  â”‚                   â”‚
â”‚  â”‚  router.pushUrl(options);                â”‚                   â”‚
â”‚  â”‚                    â†‘                     â”‚                   â”‚
â”‚  â”‚              Local ç±»å‹                  â”‚                   â”‚
â”‚  â”‚       è¿½è¸ªå˜é‡å®šä¹‰ â†’ æŸ¥æ‰¾å­—æ®µèµ‹å€¼         â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                 â”‚
â”‚  æƒ…å†µ 3: åŠ¨æ€è®¡ç®—ï¼ˆæ— æ³•é™æ€åˆ†æ âŒï¼‰                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  let page = condition ? 'A' : 'B';       â”‚                   â”‚
â”‚  â”‚  router.pushUrl({ url: page });          â”‚                   â”‚
â”‚  â”‚                        â†‘                 â”‚                   â”‚
â”‚  â”‚           è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šï¼Œæ ‡è®°ä¸º UNKNOWN  â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### 4.3.1 extractRouterUrl() â€” è·¯ç”±å‚æ•°è§£æï¼ˆè¯¦è§£ï¼‰

**åŠŸèƒ½**ï¼šä» `router.pushUrl()` æˆ– `router.replaceUrl()` è°ƒç”¨ä¸­æå–ç›®æ ‡é¡µé¢è·¯å¾„ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªï¼Ÿ**

åœ¨é¸¿è’™å¼€å‘ä¸­ï¼Œé¡µé¢è·³è½¬æœ‰å¤šç§å†™æ³•ï¼š

```typescript
// å†™æ³• 1: ç›´æ¥ä¼ å­—ç¬¦ä¸²ï¼ˆæœ€ç®€å•ï¼‰
router.pushUrl('pages/Detail');

// å†™æ³• 2: ä¼ å…¥å¯¹è±¡å­—é¢é‡ï¼ˆæœ€å¸¸è§ï¼‰
router.pushUrl({ url: 'pages/Detail' });

// å†™æ³• 3: ä½¿ç”¨å˜é‡ï¼ˆéœ€è¦è¿½è¸ªï¼‰
let options = { url: 'pages/Detail' };
router.pushUrl(options);

// å†™æ³• 4: åˆ†æ­¥éª¤æ„å»ºå¯¹è±¡
let options: RouterOptions = {};
options.url = 'pages/Detail';
router.pushUrl(options);
```

**è§£ææµç¨‹å›¾**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                extractRouterUrl() å®Œæ•´å·¥ä½œæµç¨‹                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  router.pushUrl(arg)                                            â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  åˆ¤æ–­ arg ç±»å‹                           â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚         â”‚                                                       â”‚
â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚         â–¼                 â–¼                 â–¼                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ Constant â”‚      â”‚  Local   â”‚      â”‚  å…¶ä»–    â”‚              â”‚
â”‚  â”‚ (å­—ç¬¦ä¸²) â”‚      â”‚ (å˜é‡)   â”‚      â”‚          â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜              â”‚
â”‚       â”‚                 â”‚                 â”‚                    â”‚
â”‚       â–¼                 â–¼                 â–¼                    â”‚
â”‚  ç›´æ¥è¿”å›å€¼        è¿½è¸ªå˜é‡          è¿”å› null                  â”‚
â”‚                        â”‚                                       â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚         â–¼              â–¼              â–¼                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚findField   â”‚ â”‚é€’å½’è¿½è¸ª    â”‚ â”‚æŸ¥æ‰¾åˆå§‹åŒ–  â”‚                 â”‚
â”‚  â”‚Assignment()â”‚ â”‚(å¦‚æœå³æ“ä½œ â”‚ â”‚è¿‡ç¨‹ä¸­çš„    â”‚                 â”‚
â”‚  â”‚            â”‚ â”‚ æ•°ä¹Ÿæ˜¯å˜é‡)â”‚ â”‚å­—æ®µèµ‹å€¼    â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚         â”‚              â”‚              â”‚                        â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                        â”‚                                       â”‚
â”‚                        â–¼                                       â”‚
â”‚               æ‰¾åˆ° url å­—æ®µçš„å€¼                                 â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒæ­¥éª¤è§£é‡Š**ï¼š

```
æ­¥éª¤ 1: ç±»å‹åˆ¤æ–­
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  ä»£ç : const firstArg = args[0];
  
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  ArkAnalyzer ä¼šæŠŠä»£ç è½¬æˆ IRï¼ˆä¸­é—´è¡¨ç¤ºï¼‰                    â”‚
  â”‚                                                           â”‚
  â”‚  router.pushUrl('pages/A')                                â”‚
  â”‚       â†“                                                   â”‚
  â”‚  args[0] = Constant { value: 'pages/A', type: String }    â”‚
  â”‚                                                           â”‚
  â”‚  router.pushUrl(options)                                  â”‚
  â”‚       â†“                                                   â”‚
  â”‚  args[0] = Local { name: 'options' }                      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ­¥éª¤ 2: è¿½è¸ªå˜é‡å®šä¹‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  å¦‚æœå‚æ•°æ˜¯ Local (å˜é‡)ï¼Œéœ€è¦æ‰¾åˆ°å®ƒæ˜¯åœ¨å“ªé‡Œè¢«èµ‹å€¼çš„ï¼š
  
  æºä»£ç :
    let options = { url: 'pages/Detail' };  // â† å®šä¹‰è¯­å¥
    router.pushUrl(options);                 // â† ä½¿ç”¨ä½ç½®
  
  è¿½è¸ªè¿‡ç¨‹:
    Local 'options'
        â”‚
        â–¼ getDeclaringStmt()
        â”‚
    ArkAssignStmt { left: options, right: {...} }
        â”‚
        â–¼ getRightOp()
        â”‚
    åˆ†æå¯¹è±¡çš„å±æ€§

æ­¥éª¤ 3: æŸ¥æ‰¾å­—æ®µèµ‹å€¼
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  ArkAnalyzer ä¼šæŠŠå¯¹è±¡å­—é¢é‡è½¬æˆå¤šæ¡èµ‹å€¼è¯­å¥ï¼š
  
  æºä»£ç :
    let options = { url: 'pages/Detail', params: {} };
    
  IR è¡¨ç¤º:
    $temp1 = new Object()
    $temp1.url = 'pages/Detail'      â† æ‰¾åˆ°è¿™æ¡ï¼
    $temp1.params = {}
    options = $temp1
  
  é€šè¿‡ findFieldAssignment() éå†æ‰¾åˆ° url å­—æ®µçš„èµ‹å€¼
```

**ä»£ç ç¤ºä¾‹**ï¼š

```typescript
// NavigationAnalyzer.ts ä¸­çš„å®ç°

private extractRouterUrl(invokeExpr: AbstractInvokeExpr): string | null {
    const firstArg = args[0];
    
    // æƒ…å†µ 1: ç›´æ¥æ˜¯å­—ç¬¦ä¸²å¸¸é‡
    if (firstArg instanceof Constant && firstArg.getType() instanceof StringType) {
        return firstArg.getValue();  // ç®€å•ï¼ç›´æ¥è¿”å›
    }

    // æƒ…å†µ 2: æ˜¯å˜é‡å¼•ç”¨
    if (firstArg instanceof Local) {
        return this.extractUrlFromLocalObject(firstArg);  // éœ€è¦è¿½è¸ª
    }

    return null;
}

private findFieldAssignment(local: Local, fieldName: string): string | null {
    // éå†è¯¥å˜é‡è¢«ä½¿ç”¨çš„æ‰€æœ‰è¯­å¥
    for (const stmt of local.getUsedStmts()) {
        if (stmt instanceof ArkAssignStmt) {
            const leftOp = stmt.getLeftOp();
            
            // æ£€æŸ¥æ˜¯å¦æ˜¯ obj.url = 'xxx' å½¢å¼
            if (leftOp instanceof ArkInstanceFieldRef) {
                if (leftOp.getBase().getName() === local.getName() 
                    && leftOp.getFieldName() === fieldName) {
                    // æ‰¾åˆ°äº†ï¼è¿”å›å³è¾¹çš„å€¼
                    const rightOp = stmt.getRightOp();
                    if (rightOp instanceof Constant) {
                        return rightOp.getValue();
                    }
                }
            }
        }
    }
    return null;
}
```

---

#### 4.3.2 extractWantTarget() â€” Want å¯¹è±¡è§£æï¼ˆè¯¦è§£ï¼‰

**åŠŸèƒ½**ï¼šä» `context.startAbility(want)` è°ƒç”¨ä¸­æå–ç›®æ ‡ Ability åç§°ã€‚

**ä»€ä¹ˆæ˜¯ Wantï¼Ÿ**

Want æ˜¯é¸¿è’™ä¸­ç”¨äºè·¨ Ability é€šä¿¡çš„æ•°æ®ç»“æ„ï¼Œç±»ä¼¼äº Android çš„ Intentï¼š

```typescript
// Want å¯¹è±¡ç»“æ„
let want: Want = {
    bundleName: 'com.example.app',    // åº”ç”¨åŒ…å
    abilityName: 'SecondAbility',      // ç›®æ ‡ Ability åç§°  â† æˆ‘ä»¬è¦æå–è¿™ä¸ª
    parameters: {                       // ä¼ é€’çš„å‚æ•°
        key1: 'value1'
    }
};

// å¯åŠ¨ç›®æ ‡ Ability
this.context.startAbility(want);
```

**è§£æéš¾ç‚¹**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä¸ºä»€ä¹ˆè§£æ Want æ¯”è¾ƒéš¾ï¼Ÿ                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  å†™æ³•å¤šæ ·ï¼š                                                      â”‚
â”‚                                                                 â”‚
â”‚  â‘  å¯¹è±¡å­—é¢é‡                                                   â”‚
â”‚     this.context.startAbility({                                 â”‚
â”‚         abilityName: 'SecondAbility'                            â”‚
â”‚     });                                                         â”‚
â”‚                                                                 â”‚
â”‚  â‘¡ å˜é‡ä¼ é€’                                                     â”‚
â”‚     let want = { abilityName: 'SecondAbility' };                â”‚
â”‚     this.context.startAbility(want);                            â”‚
â”‚                                                                 â”‚
â”‚  â‘¢ åˆ†æ­¥æ„å»º                                                     â”‚
â”‚     let want: Want = {};                                        â”‚
â”‚     want.bundleName = 'com.example.app';                        â”‚
â”‚     want.abilityName = 'SecondAbility';  â† éœ€è¦æ‰¾åˆ°è¿™è¡Œ         â”‚
â”‚     this.context.startAbility(want);                            â”‚
â”‚                                                                 â”‚
â”‚  â‘£ åŠ¨æ€è®¡ç®—ï¼ˆæ— æ³•é™æ€åˆ†æï¼‰                                      â”‚
â”‚     let abilityName = getAbilityName();  // è¿è¡Œæ—¶æ‰çŸ¥é“        â”‚
â”‚     this.context.startAbility({ abilityName });                 â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è§£ææµç¨‹å›¾**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              extractWantTarget() å·¥ä½œæµç¨‹                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  context.startAbility(want)                                     â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  want å‚æ•°æ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿ                                           â”‚
â”‚         â”‚                                                       â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚                            â–¼                                    â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚                     â”‚  Local   â”‚                                â”‚
â”‚                     â”‚ (å˜é‡)   â”‚                                â”‚
â”‚                     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                          â”‚                                      â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚         â–¼                â–¼                â–¼                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ æ–¹æ³•1:     â”‚   â”‚ æ–¹æ³•2:     â”‚   â”‚ æ–¹æ³•3:     â”‚              â”‚
â”‚  â”‚ findField  â”‚   â”‚ ä»åˆå§‹åŒ–   â”‚   â”‚ å›é€€æ–¹æ¡ˆ   â”‚              â”‚
â”‚  â”‚ Assignment â”‚   â”‚ è¿‡ç¨‹æŸ¥æ‰¾   â”‚   â”‚ (å˜é‡å)   â”‚              â”‚
â”‚  â”‚ ()         â”‚   â”‚            â”‚   â”‚            â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜              â”‚
â”‚         â”‚                â”‚                â”‚                     â”‚
â”‚         â–¼                â–¼                â–¼                     â”‚
â”‚    æ‰¾åˆ° abilityName å­—æ®µçš„å­—ç¬¦ä¸²å€¼                               â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚    è¿”å› "SecondAbility"                                         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®é™…ä»£ç æµç¨‹**ï¼š

```typescript
// æºä»£ç 
let want: Want = {};
want.bundleName = 'com.example.app';
want.abilityName = 'SecondAbility';
this.context.startAbility(want);

// ArkAnalyzer è½¬æˆçš„ IRï¼ˆç®€åŒ–ï¼‰
//
// Stmt 1: $temp = new Object()
// Stmt 2: want = $temp
// Stmt 3: want.bundleName = 'com.example.app'
// Stmt 4: want.abilityName = 'SecondAbility'   â† æˆ‘ä»¬è¦æ‰¾è¿™æ¡
// Stmt 5: $temp2 = this.context
// Stmt 6: invoke $temp2.startAbility(want)     â† ä»è¿™é‡Œå¼€å§‹è¿½è¸ª

// è¿½è¸ªè¿‡ç¨‹ï¼š
//   1. startAbility çš„å‚æ•°æ˜¯ want (Local)
//   2. éå† want çš„ usedStmts
//   3. æ‰¾åˆ° Stmt 4: want.abilityName = 'SecondAbility'
//   4. æ£€æŸ¥ leftOp æ˜¯ ArkInstanceFieldRefï¼ŒfieldName æ˜¯ 'abilityName'
//   5. æå– rightOp çš„å€¼: 'SecondAbility'
```

---

#### 4.3.3 checkIsEntryAbility() â€” å…¥å£ Ability è¯†åˆ«ï¼ˆè¯¦è§£ï¼‰

**åŠŸèƒ½**ï¼šåˆ¤æ–­ä¸€ä¸ª Ability æ˜¯å¦æ˜¯åº”ç”¨çš„å…¥å£ï¼ˆå¯åŠ¨æ—¶ç¬¬ä¸€ä¸ªè¿è¡Œçš„ Abilityï¼‰ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦è¯†åˆ«å…¥å£ï¼Ÿ**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DummyMain éœ€è¦çŸ¥é“ä»å“ªé‡Œå¼€å§‹                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ä¸€ä¸ªåº”ç”¨å¯èƒ½æœ‰å¤šä¸ª Ability:                                     â”‚
â”‚                                                                 â”‚
â”‚    MyApp                                                        â”‚
â”‚    â”œâ”€â”€ EntryAbility      â† å…¥å£ï¼ç”¨æˆ·ç‚¹å‡»å›¾æ ‡æ—¶å¯åŠ¨è¿™ä¸ª          â”‚
â”‚    â”œâ”€â”€ SettingsAbility                                          â”‚
â”‚    â””â”€â”€ ShareAbility                                             â”‚
â”‚                                                                 â”‚
â”‚  DummyMain å¿…é¡»ä»å…¥å£ Ability å¼€å§‹æ¨¡æ‹Ÿï¼š                         â”‚
â”‚                                                                 â”‚
â”‚    @extendedDummyMain() {                                       â”‚
â”‚        // é¦–å…ˆå¯åŠ¨å…¥å£ Ability                                  â”‚
â”‚        EntryAbility.onCreate();       â† å…¥å£å¿…é¡»ç¬¬ä¸€ä¸ª          â”‚
â”‚        EntryAbility.onWindowStageCreate();                      â”‚
â”‚        ...                                                      â”‚
â”‚        // åç»­å¯èƒ½è·³è½¬åˆ°å…¶ä»– Ability                            â”‚
â”‚        if (...) SettingsAbility.onCreate();                     â”‚
â”‚    }                                                            â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¦‚ä½•ç¡®å®šå…¥å£ï¼Ÿ**

é¸¿è’™åº”ç”¨çš„å…¥å£é…ç½®åœ¨ `module.json5` æ–‡ä»¶ä¸­ï¼š

```json5
// entry/src/main/module.json5
{
  "module": {
    "name": "entry",
    "type": "entry",
    "mainElement": "EntryAbility",     // â† è¿™é‡ŒæŒ‡å®šäº†å…¥å£ï¼
    "abilities": [
      {
        "name": "EntryAbility",
        "srcEntry": "./ets/entryability/EntryAbility.ets",
        "exported": true
      },
      {
        "name": "SettingsAbility",
        "srcEntry": "./ets/settingsability/SettingsAbility.ets"
      }
    ]
  }
}
```

**å®ç°æµç¨‹å›¾**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               checkIsEntryAbility() å®Œæ•´å·¥ä½œæµç¨‹                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ã€åˆå§‹åŒ–é˜¶æ®µ - æ„é€ å‡½æ•°ä¸­æ‰§è¡Œä¸€æ¬¡ã€‘                              â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  loadModuleConfigs()                                    â”‚    â”‚
â”‚  â”‚         â”‚                                               â”‚    â”‚
â”‚  â”‚         â–¼                                               â”‚    â”‚
â”‚  â”‚  findModuleJsonFiles(projectDir)                        â”‚    â”‚
â”‚  â”‚         â”‚                                               â”‚    â”‚
â”‚  â”‚         â–¼                                               â”‚    â”‚
â”‚  â”‚  é€’å½’æœç´¢æ‰€æœ‰ module.json5 æ–‡ä»¶                          â”‚    â”‚
â”‚  â”‚  (æ·±åº¦é™åˆ¶ 5 å±‚ï¼Œè·³è¿‡ node_modules)                      â”‚    â”‚
â”‚  â”‚         â”‚                                               â”‚    â”‚
â”‚  â”‚         â–¼                                               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚    â”‚
â”‚  â”‚  â”‚  æ‰¾åˆ°çš„æ–‡ä»¶åˆ—è¡¨:                              â”‚      â”‚    â”‚
â”‚  â”‚  â”‚  - entry/src/main/module.json5               â”‚      â”‚    â”‚
â”‚  â”‚  â”‚  - feature/src/main/module.json5             â”‚      â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚    â”‚
â”‚  â”‚         â”‚                                               â”‚    â”‚
â”‚  â”‚         â–¼                                               â”‚    â”‚
â”‚  â”‚  parseModuleJson(filePath)                              â”‚    â”‚
â”‚  â”‚         â”‚                                               â”‚    â”‚
â”‚  â”‚         â–¼                                               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚    â”‚
â”‚  â”‚  â”‚  è§£æç»“æœ:                                    â”‚      â”‚    â”‚
â”‚  â”‚  â”‚  {                                            â”‚      â”‚    â”‚
â”‚  â”‚  â”‚    moduleName: 'entry',                       â”‚      â”‚    â”‚
â”‚  â”‚  â”‚    mainElement: 'EntryAbility', â† ç¼“å­˜è¿™ä¸ª   â”‚      â”‚    â”‚
â”‚  â”‚  â”‚    abilities: [...]                           â”‚      â”‚    â”‚
â”‚  â”‚  â”‚  }                                            â”‚      â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚    â”‚
â”‚  â”‚         â”‚                                               â”‚    â”‚
â”‚  â”‚         â–¼                                               â”‚    â”‚
â”‚  â”‚  entryAbilityNames.add('EntryAbility')                 â”‚    â”‚
â”‚  â”‚                                                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â”‚  ã€åˆ¤æ–­é˜¶æ®µ - æ¯æ¬¡è°ƒç”¨ã€‘                                         â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  checkIsEntryAbility(arkClass)                          â”‚    â”‚
â”‚  â”‚         â”‚                                               â”‚    â”‚
â”‚  â”‚         â–¼                                               â”‚    â”‚
â”‚  â”‚  className = arkClass.getName()                         â”‚    â”‚
â”‚  â”‚         â”‚                                               â”‚    â”‚
â”‚  â”‚         â–¼                                               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚    â”‚
â”‚  â”‚  â”‚ entryAbilityNames     â”‚                             â”‚    â”‚
â”‚  â”‚  â”‚ æ˜¯å¦åŒ…å« classNameï¼Ÿ   â”‚                             â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚    â”‚
â”‚  â”‚              â”‚                                          â”‚    â”‚
â”‚  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚    â”‚
â”‚  â”‚      â–¼               â–¼                                 â”‚    â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”                              â”‚    â”‚
â”‚  â”‚   â”‚ æ˜¯  â”‚         â”‚ å¦  â”‚                              â”‚    â”‚
â”‚  â”‚   â””â”€â”€â”¬â”€â”€â”˜         â””â”€â”€â”¬â”€â”€â”˜                              â”‚    â”‚
â”‚  â”‚      â”‚               â”‚                                 â”‚    â”‚
â”‚  â”‚      â–¼               â–¼                                 â”‚    â”‚
â”‚  â”‚  return true    å¦‚æœæœªåŠ è½½é…ç½®:                         â”‚    â”‚
â”‚  â”‚                 ç”¨å¯å‘å¼æ–¹æ³•                             â”‚    â”‚
â”‚  â”‚                 (åç§°åŒ…å« Entry/Main)                   â”‚    â”‚
â”‚  â”‚                                                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**JSON5 è§£æç»†èŠ‚**ï¼š

```typescript
// module.json5 å¯èƒ½åŒ…å«æ³¨é‡Šï¼Œéœ€è¦å¤„ç†
{
  "module": {
    "name": "entry",
    // è¿™æ˜¯å…¥å£ Ability
    "mainElement": "EntryAbility",  /* ä¸»å…¥å£ */
    "abilities": [...]
  }
}

// è§£æä»£ç 
private parseModuleJson(filePath: string): ModuleConfig | null {
    const content = fs.readFileSync(filePath, 'utf-8');
    
    // ç§»é™¤ JSON5 æ³¨é‡Š
    const jsonContent = content
        .replace(/\/\/.*$/gm, '')        // ç§»é™¤ // æ³¨é‡Š
        .replace(/\/\*[\s\S]*?\*\//g, ''); // ç§»é™¤ /* */ æ³¨é‡Š
    
    const parsed = JSON.parse(jsonContent);
    
    return {
        moduleName: parsed.module.name,
        mainElement: parsed.module.mainElement,  // â† æå–å…¥å£
        abilities: parsed.module.abilities || []
    };
}
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```typescript
const collector = new AbilityCollector(scene);

// è‡ªåŠ¨åœ¨æ„é€ å‡½æ•°ä¸­åŠ è½½é…ç½®
// è¾“å‡º: [AbilityCollector] Found entry ability: EntryAbility in .../module.json5
// è¾“å‡º: [AbilityCollector] Loaded 2 module configs, 1 entry abilities

const abilities = collector.collectAllAbilities();

for (const ability of abilities) {
    if (ability.isEntry) {
        console.log(`å…¥å£ Ability: ${ability.name}`);
        // è¾“å‡º: å…¥å£ Ability: EntryAbility
    }
}

// ä¹Ÿå¯ä»¥ç›´æ¥è·å–å…¥å£åç§°åˆ—è¡¨
const entryNames = collector.getEntryAbilityNames();
// Set { 'EntryAbility' }
```

---

### 4.4 ViewTreeCallbackExtractor.ts â€” å›è°ƒæå–å™¨

**è§’è‰²**ï¼šUI å›è°ƒçš„"ä¾¦æ¢"ï¼Œä» ViewTree ä¸­æ‰¾å‡ºæ‰€æœ‰äº‹ä»¶ç»‘å®šã€‚

**ç±»æ¯”**ï¼šå°±åƒæ£€æŸ¥å‘˜æ£€æŸ¥æ¯ä¸ªæŒ‰é’®ä¸Šè´´äº†ä»€ä¹ˆæ ‡ç­¾ã€‚

#### ä¸åŸæ–¹æ³•çš„å¯¹æ¯”

```
åŸç‰ˆ DummyMainCreater.getCallbackMethods():
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ éå†æ‰€æœ‰è¯­å¥                         â”‚
â”‚ æ‰¾åˆ° onClick(...) è°ƒç”¨              â”‚
â”‚ æå–å‚æ•°ä¸­çš„æ–¹æ³•                     â”‚
â”‚                                     â”‚
â”‚ ç»“æœ: [method1, method2, method3]   â”‚
â”‚       ï¼ˆä¸çŸ¥é“å±äºå“ªä¸ªæ§ä»¶ï¼‰          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æœ¬æ¨¡å— ViewTreeCallbackExtractor:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ éå† ViewTree èŠ‚ç‚¹                   â”‚
â”‚ æ£€æŸ¥æ¯ä¸ªèŠ‚ç‚¹çš„ attributes            â”‚
â”‚ æ‰¾åˆ° onClick, onTouch ç­‰äº‹ä»¶        â”‚
â”‚ è®°å½•æ§ä»¶ç±»å‹å’Œå›è°ƒæ–¹æ³•               â”‚
â”‚                                     â”‚
â”‚ ç»“æœ:                               â”‚
â”‚ [                                   â”‚
â”‚   { type: 'Button',                 â”‚
â”‚     event: 'onClick',               â”‚
â”‚     method: handler1 },             â”‚
â”‚   { type: 'Text',                   â”‚
â”‚     event: 'onAppear',              â”‚
â”‚     method: handler2 }              â”‚
â”‚ ]                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ ¸å¿ƒæ–¹æ³•

```typescript
class ViewTreeCallbackExtractor {
    /**
     * ä» Component æå–æ‰€æœ‰ UI å›è°ƒ
     */
    extractFromComponent(componentClass: ArkClass): UICallbackInfo[] {
        // 1. è·å– ViewTree
        const viewTree = componentClass.getViewTree();
        
        // 2. è·å–æ ¹èŠ‚ç‚¹
        const root = viewTree.getRoot();
        
        // 3. é€’å½’éå†
        this.walkViewTree(root, callbacks);
        
        return callbacks;
    }
    
    /**
     * éå† ViewTree
     * 
     * ViewTree ç»“æ„ç¤ºä¾‹:
     * 
     *   Column (root)
     *     â”œâ”€â”€ Text
     *     â”‚     â””â”€â”€ attributes: { text: 'Hello' }
     *     â””â”€â”€ Button
     *           â””â”€â”€ attributes: { onClick: [handler] }  â† æˆ‘ä»¬è¦æ‰¾çš„ï¼
     */
    private walkViewTree(node, callbacks) {
        // æå–å½“å‰èŠ‚ç‚¹çš„å›è°ƒ
        for (const [name, value] of node.attributes) {
            if (isEventAttribute(name)) {  // onClick, onTouch...
                const method = resolveCallbackMethod(value);
                callbacks.push({
                    componentType: node.name,  // "Button"
                    eventType: name,           // "onClick"
                    callbackMethod: method
                });
            }
        }
        
        // é€’å½’å¤„ç†å­èŠ‚ç‚¹
        for (const child of node.children) {
            this.walkViewTree(child, callbacks);
        }
    }
}
```

---

#### 4.5.1 resolveCallbackMethod() â€” å›è°ƒæ–¹æ³•è§£æï¼ˆè¯¦è§£ï¼‰

**åŠŸèƒ½**ï¼šä» ViewTree èŠ‚ç‚¹çš„å±æ€§å€¼ä¸­è§£æå‡ºå®é™…çš„å›è°ƒæ–¹æ³•ï¼ˆArkMethodï¼‰ã€‚

**ä¸ºä»€ä¹ˆè¿™ä¸ªæ–¹æ³•é‡è¦ï¼Ÿ**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               å›è°ƒè§£æåœ¨æ•´ä¸ªæµç¨‹ä¸­çš„ä½ç½®                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  æºä»£ç                                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                      â”‚
â”‚  Button('Click').onClick(this.handleClick)                      â”‚
â”‚                                                                 â”‚
â”‚         â†“ ArkAnalyzer è§£æ                                      â”‚
â”‚                                                                 â”‚
â”‚  ViewTree èŠ‚ç‚¹                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚
â”‚  {                                                              â”‚
â”‚    name: 'Button',                                              â”‚
â”‚    attributes: Map {                                            â”‚
â”‚      'onClick' => [Stmt, [MethodSignature/FieldRef/...]]       â”‚
â”‚    }                   â†‘                                        â”‚
â”‚  }                     â”‚                                        â”‚
â”‚                        â”‚ resolveCallbackMethod() çš„è¾“å…¥         â”‚
â”‚                        â”‚                                        â”‚
â”‚         â†“              â”‚                                        â”‚
â”‚                        â”‚                                        â”‚
â”‚  æˆ‘ä»¬éœ€è¦çš„                                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                      â”‚
â”‚  ArkMethod { name: 'handleClick', body: {...} }                 â”‚
â”‚                                                                 â”‚
â”‚         â†“ ç”¨äº DummyMain                                        â”‚
â”‚                                                                 â”‚
â”‚  DummyMain CFG ä¸­è°ƒç”¨:                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚  component.handleClick()  â† é™æ€åˆ†æå¯ä»¥è§¦è¾¾è¿™é‡Œçš„ä»£ç ï¼        â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¼€å‘è€…å†™å›è°ƒçš„å¤šç§æ–¹å¼**ï¼š

```typescript
// æ–¹å¼ 1: æ–¹æ³•å¼•ç”¨ï¼ˆæœ€å¸¸è§ï¼‰
@Component
struct MyComponent {
    handleClick() {
        console.log('clicked');
    }
    
    build() {
        Button('Click')
            .onClick(this.handleClick)  // â† éœ€è¦è§£æ
    }
}

// æ–¹å¼ 2: ç®­å¤´å‡½æ•° Lambda
Button('Click')
    .onClick(() => {                    // â† éœ€è¦è§£æ
        this.count++;
    })

// æ–¹å¼ 3: å†…è”å‡½æ•°
Button('Click')
    .onClick(function() {               // â† éœ€è¦è§£æ
        doSomething();
    })
```

**è§£ææµç¨‹å›¾**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             resolveCallbackMethod() å®Œæ•´å·¥ä½œæµç¨‹                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  è¾“å…¥: attributeValue = [Stmt, Values[]]                        â”‚
â”‚                              â”‚                                  â”‚
â”‚                              â–¼                                  â”‚
â”‚                     éå† Values æ•°ç»„                            â”‚
â”‚                              â”‚                                  â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚        â–¼                     â–¼                     â–¼            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ MethodSignatureâ”‚   â”‚ArkInstanceFldâ”‚   â”‚   Constant    â”‚     â”‚
â”‚  â”‚  (æ–¹æ³•ç­¾å)    â”‚   â”‚  Ref (å­—æ®µ)  â”‚   â”‚ (å­—ç¬¦ä¸²å¸¸é‡)  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚          â”‚                   â”‚                   â”‚              â”‚
â”‚          â–¼                   â–¼                   â–¼              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚1.scene.getMethodâ”‚ â”‚1.getFieldName()â”‚   â”‚1.getValue()   â”‚     â”‚
â”‚  â”‚2.class.getMethodâ”‚ â”‚2.ä½œä¸ºæ–¹æ³•åæŸ¥æ‰¾â”‚   â”‚2.ä½œä¸ºæ–¹æ³•å   â”‚     â”‚
â”‚  â”‚3.æŒ‰åç§°æŸ¥æ‰¾    â”‚ â”‚3.æ£€æŸ¥çˆ¶ç±»      â”‚   â”‚  æŸ¥æ‰¾        â”‚     â”‚
â”‚  â”‚4.æ£€æŸ¥çˆ¶ç±»      â”‚ â”‚               â”‚   â”‚3.æ£€æŸ¥çˆ¶ç±»     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚          â”‚                   â”‚                   â”‚              â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                              â”‚                                  â”‚
â”‚                              â–¼                                  â”‚
â”‚                    æ‰¾åˆ° ArkMethod?                              â”‚
â”‚                     /          \                                â”‚
â”‚                   æ˜¯            å¦                              â”‚
â”‚                   â”‚              â”‚                              â”‚
â”‚                   â–¼              â–¼                              â”‚
â”‚              è¿”å›æ–¹æ³•      å°è¯• Lambda è§£æ                      â”‚
â”‚                              â”‚                                  â”‚
â”‚                              â–¼                                  â”‚
â”‚                    resolveLambdaFromStmt()                      â”‚
â”‚                    (æ£€æŸ¥æ˜¯å¦æœ‰åŒ¿åæ–¹æ³•)                          â”‚
â”‚                              â”‚                                  â”‚
â”‚                              â–¼                                  â”‚
â”‚                      è¿”å›ç»“æœæˆ– null                            â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ArkAnalyzer å¦‚ä½•è¡¨ç¤ºå›è°ƒï¼Ÿ**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            ViewTree å±æ€§çš„æ•°æ®ç»“æ„                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  node.attributes æ˜¯ Map<string, [Stmt, Value[]]>               â”‚
â”‚                                                                 â”‚
â”‚  ä¾‹å¦‚ï¼šonClick(this.handleClick) è¢«è§£æä¸º:                      â”‚
â”‚                                                                 â”‚
â”‚  'onClick' => [                                                 â”‚
â”‚      ArkInvokeStmt,           // å…³è”çš„è¯­å¥                     â”‚
â”‚      [                                                          â”‚
â”‚          MethodSignature {    // æ–¹æ³•ç­¾å                       â”‚
â”‚              className: 'MyComponent',                          â”‚
â”‚              methodName: 'handleClick',                         â”‚
â”‚              ...                                                â”‚
â”‚          }                                                      â”‚
â”‚      ]                                                          â”‚
â”‚  ]                                                              â”‚
â”‚                                                                 â”‚
â”‚  æˆ–è€… onClick(this.handler) å¯èƒ½è¢«è§£æä¸º:                       â”‚
â”‚                                                                 â”‚
â”‚  'onClick' => [                                                 â”‚
â”‚      ArkInvokeStmt,                                             â”‚
â”‚      [                                                          â”‚
â”‚          ArkInstanceFieldRef {  // å­—æ®µå¼•ç”¨                     â”‚
â”‚              base: Local('this'),                               â”‚
â”‚              fieldName: 'handler'                               â”‚
â”‚          }                                                      â”‚
â”‚      ]                                                          â”‚
â”‚  ]                                                              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒè§£æä»£ç ç¤ºä¾‹**ï¼š

```typescript
private resolveCallbackMethod(
    attributeValue: [Stmt, Value[]],
    componentClass: ArkClass
): ArkMethod | null {
    const [stmt, values] = attributeValue;
    
    for (const value of values) {
        // æƒ…å†µ 1: æ–¹æ³•ç­¾å
        if (value instanceof MethodSignature) {
            // ä¼˜å…ˆä» Scene å…¨å±€æŸ¥æ‰¾
            let method = this.scene.getMethod(value);
            if (method) return method;
            
            // å…¶æ¬¡ä»å½“å‰ç±»æŸ¥æ‰¾
            method = componentClass.getMethod(value);
            if (method) return method;
            
            // æœ€åæŒ‰åç§°æŸ¥æ‰¾
            const name = value.getMethodSubSignature().getMethodName();
            method = componentClass.getMethodWithName(name);
            if (method) return method;
        }
        
        // æƒ…å†µ 2: å­—æ®µå¼•ç”¨ (this.xxx)
        if (value instanceof ArkInstanceFieldRef) {
            const fieldName = value.getFieldName();
            // å°†å­—æ®µåä½œä¸ºæ–¹æ³•åæŸ¥æ‰¾
            const method = componentClass.getMethodWithName(fieldName);
            if (method) return method;
        }
        
        // æƒ…å†µ 3: å­—ç¬¦ä¸²å¸¸é‡
        if (value instanceof Constant && typeof value.getValue() === 'string') {
            const method = componentClass.getMethodWithName(value.getValue());
            if (method) return method;
        }
    }
    
    return null;
}
```

**Lambda è¡¨è¾¾å¼çš„å¤„ç†**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Lambda è¡¨è¾¾å¼çš„ç‰¹æ®Šå¤„ç†                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  æºä»£ç :                                                        â”‚
â”‚  Button().onClick(() => { this.count++; })                      â”‚
â”‚                                                                 â”‚
â”‚  ArkAnalyzer å¯èƒ½çš„å¤„ç†æ–¹å¼:                                     â”‚
â”‚                                                                 â”‚
â”‚  æ–¹å¼ 1: ç”ŸæˆåŒ¿åæ–¹æ³•                                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚  class MyComponent {                                            â”‚
â”‚      // åŸæœ‰æ–¹æ³•                                                â”‚
â”‚      build() { ... }                                            â”‚
â”‚                                                                 â”‚
â”‚      // ArkAnalyzer ç”Ÿæˆçš„ Lambda æ–¹æ³•                          â”‚
â”‚      lambda$onClick$1() {                                       â”‚
â”‚          this.count++;                                          â”‚
â”‚      }                                                          â”‚
â”‚  }                                                              â”‚
â”‚                                                                 â”‚
â”‚  æ–¹å¼ 2: å†…è”åˆ°è°ƒç”¨ç‚¹                                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚  ViewTree çš„ Stmt ä¸­ç›´æ¥åŒ…å« Lambda çš„ä»£ç                        â”‚
â”‚                                                                 â”‚
â”‚  å½“å‰å®ç°:                                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                      â”‚
â”‚  - æ–¹å¼ 1 çš„ Lambda æ–¹æ³•å¯ä»¥é€šè¿‡æ–¹æ³•åæ¨¡å¼åŒ¹é…æ‰¾åˆ°               â”‚
â”‚  - æ–¹å¼ 2 éœ€è¦åˆ†æ Stmt ç»“æ„ï¼ˆå¤æ‚ï¼Œæš‚æœªå®Œå…¨å®ç°ï¼‰              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ViewTree éå†ç¤ºæ„

```
æºä»£ç :
build() {
    Column() {
        Text('Title')
        Button('Submit')
            .onClick(() => { submit(); })
        Row() {
            Image('icon.png')
                .onAppear(() => { load(); })
        }
    }
}

ViewTree ç»“æ„:                    æå–ç»“æœ:
     Column                       
       â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”œâ”€â”€ Text                   â”‚ 1. Button.onClick â†’ submit   â”‚
       â”‚                          â”‚ 2. Image.onAppear â†’ load     â”‚
       â”œâ”€â”€ Button â†â”€â”€ onClick     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â””â”€â”€ Row
             â”‚
             â””â”€â”€ Image â†â”€â”€ onAppear
```

---

### 4.4 LifecycleModelCreator.ts â€” æ ¸å¿ƒæ„å»ºå™¨

**è§’è‰²**ï¼šæ€»æŒ‡æŒ¥ï¼Œåè°ƒæ‰€æœ‰éƒ¨ä»¶ï¼Œç”Ÿæˆæœ€ç»ˆçš„ DummyMainã€‚

**ç±»æ¯”**ï¼šå°±åƒå»ºç­‘å·¥åœ°çš„é¡¹ç›®ç»ç†ï¼Œè°ƒåº¦å„ä¸ªå·¥ç§å®Œæˆæ•´æ ‹å¤§æ¥¼ã€‚

#### æ„å»ºæµç¨‹

```mermaid
sequenceDiagram
    participant User as ä½¿ç”¨è€…
    participant Creator as LifecycleModelCreator
    participant Collector as AbilityCollector
    participant Extractor as ViewTreeCallbackExtractor
    participant CFG as CFG Builder
    
    User->>Creator: create()
    
    Note over Creator: Step 1: æ”¶é›†ä¿¡æ¯
    Creator->>Collector: collectAllAbilities()
    Collector-->>Creator: AbilityInfo[]
    Creator->>Collector: collectAllComponents()
    Collector-->>Creator: ComponentInfo[]
    
    Note over Creator: Step 2: æå–å›è°ƒ
    Creator->>Extractor: fillAllComponentCallbacks()
    Extractor-->>Creator: UICallbackInfo[] (å¡«å…¥ ComponentInfo)
    
    Note over Creator: Step 3: åˆ›å»ºå®¹å™¨
    Creator->>Creator: createDummyMainContainer()
    Note right of Creator: åˆ›å»ºè™šæ‹Ÿ File, Class, Method
    
    Note over Creator: Step 4: æ„å»º CFG
    Creator->>CFG: buildDummyMainCfg()
    CFG->>CFG: addStaticInitialization()
    CFG->>CFG: createMainLoopStructure()
    loop æ¯ä¸ª Ability
        CFG->>CFG: addAbilityLifecycleBranch()
    end
    loop æ¯ä¸ª Component
        CFG->>CFG: addComponentLifecycleBranch()
    end
    CFG-->>Creator: Cfg
    
    Note over Creator: Step 5: æ³¨å†Œ
    Creator->>Creator: scene.addToMethodsMap()
    
    Creator-->>User: å®Œæˆï¼
```

#### æ ¸å¿ƒæ–¹æ³•è¯¦è§£

```typescript
class LifecycleModelCreator {
    /**
     * ä¸»å…¥å£æ–¹æ³•
     * 
     * æ‰§è¡Œå®Œæ•´çš„æ„å»ºæµç¨‹
     */
    create(): void {
        // Step 1: æ”¶é›†æ‰€æœ‰ Ability å’Œ Component
        this.collectAbilitiesAndComponents();
        
        // Step 2: ä» ViewTree æå– UI å›è°ƒ
        this.extractUICallbacks();
        
        // Step 3: åˆ›å»º DummyMain çš„"å¤–å£³"
        this.createDummyMainContainer();
        
        // Step 4: æ„å»ºæ§åˆ¶æµå›¾
        this.buildDummyMainCfg();
        
        // Step 5: æ³¨å†Œåˆ° Scene
        this.scene.addToMethodsMap(this.dummyMain);
    }
    
    /**
     * æ„å»º CFG
     * 
     * CFG (Control Flow Graph) æ§åˆ¶æµå›¾
     * è¡¨ç¤ºç¨‹åºçš„æ‰§è¡Œè·¯å¾„
     */
    private buildDummyMainCfg(): void {
        // åˆ›å»ºå…¥å£å—
        const entryBlock = new BasicBlock();
        
        // æ·»åŠ é™æ€åˆå§‹åŒ–
        this.addStaticInitialization(cfg, entryBlock);
        
        // åˆ›å»º while(true) å¾ªç¯
        const { whileBlock, countLocal } = this.createMainLoopStructure();
        
        // ä¸ºæ¯ä¸ª Ability åˆ›å»ºåˆ†æ”¯
        for (const ability of this.abilities) {
            this.addAbilityLifecycleBranch(ability, ...);
        }
        
        // ä¸ºæ¯ä¸ª Component åˆ›å»ºåˆ†æ”¯
        for (const component of this.components) {
            this.addComponentLifecycleBranch(component, ...);
        }
    }
    
    /**
     * æ·»åŠ  Ability ç”Ÿå‘½å‘¨æœŸåˆ†æ”¯
     * 
     * ç”Ÿæˆçš„ä»£ç ç»“æ„:
     * if (count == N) {
     *     ability = new AbilityClass();
     *     ability.onCreate(want);
     *     ability.onWindowStageCreate(windowStage);
     *     ability.onForeground();
     *     // ...
     * }
     */
    private addAbilityLifecycleBranch(ability: AbilityInfo, ...): BasicBlock[] {
        // åˆ›å»ºæ¡ä»¶å—: if (count == N)
        const ifBlock = createIfBlock(count == branchIndex);
        
        // åˆ›å»ºè°ƒç”¨å—
        const invokeBlock = new BasicBlock();
        
        // å®ä¾‹åŒ– Ability
        const local = new Local('ability', AbilityType);
        addStmt(invokeBlock, `${local} = new ${ability.name}()`);
        
        // æŒ‰é¡ºåºè°ƒç”¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•
        for (const stage of [CREATE, WINDOW_STAGE_CREATE, FOREGROUND, ...]) {
            const method = ability.lifecycleMethods.get(stage);
            if (method) {
                addStmt(invokeBlock, `${local}.${method.getName()}()`);
            }
        }
        
        return [ifBlock, invokeBlock];
    }
}
```

---

#### 4.6.1 addMethodInvocation() â€” æ–¹æ³•è°ƒç”¨ä¸å‚æ•°ç”Ÿæˆï¼ˆè¯¦è§£ï¼‰

**åŠŸèƒ½**ï¼šç”Ÿæˆç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„è°ƒç”¨è¯­å¥ï¼Œå¹¶è‡ªåŠ¨ä¸ºæ–¹æ³•å‚æ•°åˆ›å»ºå¯¹åº”çš„å¯¹è±¡ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦å‚æ•°ç”Ÿæˆï¼Ÿ**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä¸ºä»€ä¹ˆå‚æ•°ç”Ÿæˆå¾ˆé‡è¦ï¼Ÿ                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  é¸¿è’™ Ability çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•éœ€è¦å‚æ•°ï¼š                           â”‚
â”‚                                                                 â”‚
â”‚  class EntryAbility extends UIAbility {                         â”‚
â”‚      onCreate(want: Want, launchParam: LaunchParam) {           â”‚
â”‚          //     â†‘            â†‘                                  â”‚
â”‚          //     â”‚            â””â”€â”€ å¯åŠ¨å‚æ•°                       â”‚
â”‚          //     â””â”€â”€ åŒ…å«å¤–éƒ¨ä¼ å…¥çš„æ•°æ®ï¼ˆå¯èƒ½æ˜¯æ•æ„Ÿæ•°æ®ï¼ï¼‰       â”‚
â”‚                                                                 â”‚
â”‚          let data = want.parameters['key'];  // æ±¡ç‚¹æºï¼        â”‚
â”‚          sendToServer(data);                 // å¦‚æœè¿½è¸ªä¸åˆ°è¿™é‡Œâ”‚
â”‚      }                                       // å°±å‘ç°ä¸äº†æ³„éœ²  â”‚
â”‚  }                                                              â”‚
â”‚                                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                                 â”‚
â”‚  æ²¡æœ‰å‚æ•°ç”Ÿæˆæ—¶ï¼š                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  DummyMain:                              â”‚                   â”‚
â”‚  â”‚  ability.onCreate()  â† æ²¡æœ‰ want å‚æ•°ï¼  â”‚                   â”‚
â”‚  â”‚                                          â”‚                   â”‚
â”‚  â”‚  é™æ€åˆ†æç»“æœï¼š                           â”‚                   â”‚
â”‚  â”‚  æ— æ³•è¿½è¸ª want ä¸­çš„æ•°æ®æµ âŒ              â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                 â”‚
â”‚  æœ‰å‚æ•°ç”Ÿæˆæ—¶ï¼š                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  DummyMain:                              â”‚                   â”‚
â”‚  â”‚  %param0 = new Want()                    â”‚                   â”‚
â”‚  â”‚  %param1 = new LaunchParam()             â”‚                   â”‚
â”‚  â”‚  ability.onCreate(%param0, %param1)      â”‚                   â”‚
â”‚  â”‚                                          â”‚                   â”‚
â”‚  â”‚  é™æ€åˆ†æç»“æœï¼š                           â”‚                   â”‚
â”‚  â”‚  å¯ä»¥è¿½è¸ª want â†’ parameters â†’ sendToServer âœ… â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**éœ€è¦ç”Ÿæˆå‚æ•°çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•**ï¼š

| æ–¹æ³• | å‚æ•° | é‡è¦æ€§ |
|------|------|:------:|
| `onCreate(want, launchParam)` | Want, LaunchParam | â­â­â­â­â­ |
| `onWindowStageCreate(windowStage)` | WindowStage | â­â­â­â­ |
| `onForeground()` | æ—  | - |
| `onBackground()` | æ—  | - |
| `onDestroy()` | æ—  | - |

**å®ç°æµç¨‹å›¾**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             addMethodInvocation() å®Œæ•´å·¥ä½œæµç¨‹                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  è¾“å…¥: method (å¦‚ onCreate), instanceLocal (ability å®ä¾‹)       â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  Step 1: è·å–æ–¹æ³•å‚æ•°åˆ—è¡¨                            â”‚       â”‚
â”‚  â”‚  parameters = method.getParameters()                 â”‚       â”‚
â”‚  â”‚  // [Parameter{name:'want', type:Want},              â”‚       â”‚
â”‚  â”‚  //  Parameter{name:'launchParam', type:LaunchParam}]â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  Step 2: ä¸ºæ¯ä¸ªå‚æ•°åˆ›å»º Local å’Œåˆå§‹åŒ–è¯­å¥           â”‚       â”‚
â”‚  â”‚                                                      â”‚       â”‚
â”‚  â”‚  for (param of parameters) {                         â”‚       â”‚
â”‚  â”‚      paramType = param.getType()                     â”‚       â”‚
â”‚  â”‚                                                      â”‚       â”‚
â”‚  â”‚      // å¦‚æœç±»å‹æœªçŸ¥ï¼Œä»çˆ¶ç±»è·å–                     â”‚       â”‚
â”‚  â”‚      if (!paramType) {                               â”‚       â”‚
â”‚  â”‚          paramType = getParamTypeFromSuperClass()    â”‚       â”‚
â”‚  â”‚      }                                               â”‚       â”‚
â”‚  â”‚                                                      â”‚       â”‚
â”‚  â”‚      // åˆ›å»º Local å˜é‡                              â”‚       â”‚
â”‚  â”‚      paramLocal = new Local('%param0', paramType)    â”‚       â”‚
â”‚  â”‚                                                      â”‚       â”‚
â”‚  â”‚      // å¦‚æœæ˜¯ ClassTypeï¼Œç”Ÿæˆ new è¯­å¥              â”‚       â”‚
â”‚  â”‚      if (paramType instanceof ClassType) {           â”‚       â”‚
â”‚  â”‚          block.addStmt: %param0 = new Want()         â”‚       â”‚
â”‚  â”‚      }                                               â”‚       â”‚
â”‚  â”‚  }                                                   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  Step 3: ç”Ÿæˆæ–¹æ³•è°ƒç”¨è¯­å¥                            â”‚       â”‚
â”‚  â”‚                                                      â”‚       â”‚
â”‚  â”‚  invokeExpr = new ArkInstanceInvokeExpr(             â”‚       â”‚
â”‚  â”‚      instanceLocal,     // ability                   â”‚       â”‚
â”‚  â”‚      method.getSignature(), // onCreate ç­¾å         â”‚       â”‚
â”‚  â”‚      paramLocals        // [%param0, %param1]        â”‚       â”‚
â”‚  â”‚  )                                                   â”‚       â”‚
â”‚  â”‚                                                      â”‚       â”‚
â”‚  â”‚  block.addStmt: ability.onCreate(%param0, %param1)   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç”Ÿæˆçš„ IR ç¤ºä¾‹**ï¼š

```
æºä»£ç ä¸­çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
class EntryAbility extends UIAbility {
    onCreate(want: Want, launchParam: LaunchParam) { ... }
    onWindowStageCreate(windowStage: WindowStage) { ... }
    onForeground() { ... }
}

ç”Ÿæˆçš„ DummyMain IRï¼ˆä¸­é—´è¡¨ç¤ºï¼‰ï¼š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// å®ä¾‹åŒ– Ability
%ability0 = new EntryAbility()
invoke %ability0.<init>()

// onCreate è°ƒç”¨ï¼ˆå«å‚æ•°ï¼‰
%param0 = new Want()           // â† å‚æ•°å¯¹è±¡åˆ›å»º
%param1 = new LaunchParam()    // â† å‚æ•°å¯¹è±¡åˆ›å»º
invoke %ability0.onCreate(%param0, %param1)

// onWindowStageCreate è°ƒç”¨ï¼ˆå«å‚æ•°ï¼‰
%param2 = new WindowStage()    // â† å‚æ•°å¯¹è±¡åˆ›å»º
invoke %ability0.onWindowStageCreate(%param2)

// onForeground è°ƒç”¨ï¼ˆæ— å‚æ•°ï¼‰
invoke %ability0.onForeground()
```

**å‚æ•°ç±»å‹è·å–çš„ç‰¹æ®Šå¤„ç†**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ä¸ºä»€ä¹ˆéœ€è¦ä»çˆ¶ç±»è·å–å‚æ•°ç±»å‹ï¼Ÿ                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  é—®é¢˜åœºæ™¯ï¼š                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  // ç”¨æˆ·ä»£ç ï¼ˆå¯èƒ½æ²¡æœ‰æ˜¾å¼å†™å‚æ•°ç±»å‹ï¼‰                   â”‚   â”‚
â”‚  â”‚  class MyAbility extends UIAbility {                     â”‚   â”‚
â”‚  â”‚      onCreate(want, param) {  // â† ç±»å‹å¯èƒ½ä¸º undefined  â”‚   â”‚
â”‚  â”‚          ...                                             â”‚   â”‚
â”‚  â”‚      }                                                   â”‚   â”‚
â”‚  â”‚  }                                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  è§£å†³æ–¹æ¡ˆï¼šä» SDK çš„çˆ¶ç±»æ–¹æ³•è·å–ç±»å‹                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  // SDK ä¸­çš„ UIAbility åŸºç±»ï¼ˆç±»å‹å®Œæ•´ï¼‰                  â”‚   â”‚
â”‚  â”‚  class UIAbility {                                       â”‚   â”‚
â”‚  â”‚      onCreate(want: Want, launchParam: LaunchParam) {}   â”‚   â”‚
â”‚  â”‚  }                          â†‘            â†‘               â”‚   â”‚
â”‚  â”‚                             â”‚            â”‚               â”‚   â”‚
â”‚  â”‚                    ä»è¿™é‡Œè·å–å‚æ•°ç±»å‹                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒä»£ç å®ç°**ï¼š

```typescript
private addMethodInvocation(
    block: BasicBlock,
    instanceLocal: Local,
    method: ArkMethod
): void {
    // Step 1: ä¸ºæ–¹æ³•å‚æ•°åˆ›å»º Local å˜é‡å¹¶åˆå§‹åŒ–
    const paramLocals = this.createParameterLocals(method, block);
    
    // Step 2: ç”Ÿæˆæ–¹æ³•è°ƒç”¨è¯­å¥
    const invokeExpr = new ArkInstanceInvokeExpr(
        instanceLocal,
        method.getSignature(),
        paramLocals  // â† ä¼ å…¥å‚æ•°ï¼
    );
    const invokeStmt = new ArkInvokeStmt(invokeExpr);
    block.addStmt(invokeStmt);
}

private createParameterLocals(method: ArkMethod, block: BasicBlock): Local[] {
    const paramLocals: Local[] = [];
    
    for (const param of method.getParameters()) {
        let paramType = param.getType();
        
        // ç±»å‹æœªçŸ¥æ—¶ï¼Œä»çˆ¶ç±»è·å–
        if (!paramType) {
            paramType = this.getParamTypeFromSuperClass(method, paramIndex);
        }
        
        // åˆ›å»ºå‚æ•° Local
        const paramLocal = new Local('%param' + index, paramType);
        
        // ClassType éœ€è¦ new è¯­å¥
        if (paramType instanceof ClassType) {
            const newExpr = new ArkNewExpr(paramType);
            const assignStmt = new ArkAssignStmt(paramLocal, newExpr);
            block.addStmt(assignStmt);
        }
        
        paramLocals.push(paramLocal);
    }
    
    return paramLocals;
}
```

---

## 5. å®Œæ•´æµç¨‹è§£æ

### 5.1 ä»ä»£ç åˆ° DummyMain çš„å®Œæ•´æ—…ç¨‹

å‡è®¾æˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ªé¸¿è’™é¡¹ç›®ï¼š

```typescript
// EntryAbility.ets
export default class EntryAbility extends UIAbility {
    onCreate(want: Want) {
        console.log('Ability created');
    }
    onForeground() {
        console.log('Ability foreground');
    }
}

// Index.ets
@Entry
@Component
struct Index {
    @State count: number = 0;
    
    aboutToAppear() {
        console.log('Component appear');
    }
    
    build() {
        Column() {
            Text(`Count: ${this.count}`)
            Button('Add')
                .onClick(() => {
                    this.count++;
                })
        }
    }
}
```

### 5.2 æµç¨‹å›¾è§£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Step 1: æ”¶é›†ä¿¡æ¯                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Scene.getClasses() è¿”å›:                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚  â”‚ EntryAbility    â”‚  â”‚ Index           â”‚                              â”‚
â”‚  â”‚ extends         â”‚  â”‚ @Component      â”‚                              â”‚
â”‚  â”‚ UIAbility       â”‚  â”‚ @Entry          â”‚                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚           â”‚                    â”‚                                        â”‚
â”‚           â–¼                    â–¼                                        â”‚
â”‚  isAbilityClass()? âœ“   isComponentClass()? âœ“                           â”‚
â”‚           â”‚                    â”‚                                        â”‚
â”‚           â–¼                    â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚  â”‚ AbilityInfo:    â”‚  â”‚ ComponentInfo:  â”‚                              â”‚
â”‚  â”‚ name: Entry...  â”‚  â”‚ name: Index     â”‚                              â”‚
â”‚  â”‚ methods:        â”‚  â”‚ methods:        â”‚                              â”‚
â”‚  â”‚  onCreate âœ“     â”‚  â”‚  aboutToAppearâœ“ â”‚                              â”‚
â”‚  â”‚  onForeground âœ“ â”‚  â”‚  build âœ“        â”‚                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Step 2: æå– UI å›è°ƒ                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Index.getViewTree():                                                   â”‚
â”‚                                                                         â”‚
â”‚       Column                                                            â”‚
â”‚         â”œâ”€â”€ Text                                                        â”‚
â”‚         â”‚     â””â”€â”€ attributes: {}                                        â”‚
â”‚         â””â”€â”€ Button                                                      â”‚
â”‚               â””â”€â”€ attributes: { onClick: [lambda] }                     â”‚
â”‚                                      â”‚                                  â”‚
â”‚                                      â–¼                                  â”‚
â”‚                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚                             â”‚ UICallbackInfo: â”‚                         â”‚
â”‚                             â”‚ type: Button    â”‚                         â”‚
â”‚                             â”‚ event: onClick  â”‚                         â”‚
â”‚                             â”‚ method: lambda  â”‚                         â”‚
â”‚                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Step 3: åˆ›å»ºå®¹å™¨                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  åˆ›å»ºè™šæ‹Ÿç»“æ„:                                                           â”‚
â”‚                                                                         â”‚
â”‚  @extendedDummyFile (è™šæ‹Ÿæ–‡ä»¶)                                          â”‚
â”‚      â””â”€â”€ @extendedDummyClass (è™šæ‹Ÿç±»)                                   â”‚
â”‚              â””â”€â”€ @extendedDummyMain() (è™šæ‹Ÿæ–¹æ³•) â† è¿™å°±æ˜¯æˆ‘ä»¬çš„ç›®æ ‡      â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Step 4: æ„å»º CFG                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  ç”Ÿæˆçš„æ§åˆ¶æµå›¾:                                                         â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                        â”‚
â”‚  â”‚ Entry Block â”‚ staticInit(); count = 0;                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                        â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ While Block â”‚ while (true)                         â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                      â”‚                â”‚
â”‚         â”‚                                             â”‚                â”‚
â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                                        â”‚                â”‚
â”‚    â–¼         â–¼                                        â”‚                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”                                     â”‚                â”‚
â”‚ â”‚if==1â”‚   â”‚if==2â”‚                                     â”‚                â”‚
â”‚ â””â”€â”€â”¬â”€â”€â”˜   â””â”€â”€â”¬â”€â”€â”˜                                     â”‚                â”‚
â”‚    â”‚         â”‚                                        â”‚                â”‚
â”‚    â–¼         â–¼                                        â”‚                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                â”‚
â”‚ â”‚ Ability åˆ†æ”¯:    â”‚  â”‚ Component åˆ†æ”¯:          â”‚   â”‚                â”‚
â”‚ â”‚ ability = new    â”‚  â”‚ comp = new Index()       â”‚   â”‚                â”‚
â”‚ â”‚   EntryAbility() â”‚  â”‚ comp.aboutToAppear()     â”‚   â”‚                â”‚
â”‚ â”‚ ability.onCreate â”‚  â”‚ comp.build()             â”‚   â”‚                â”‚
â”‚ â”‚ ability.onFore.. â”‚  â”‚ comp.onClick_handler()   â”‚   â”‚                â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                â”‚
â”‚          â”‚                         â”‚                  â”‚                â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                         â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚
â”‚  â”‚ Return Block â”‚ return;                                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                       â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Step 5: æ³¨å†Œåˆ° Scene                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  scene.addToMethodsMap(dummyMain)                                       â”‚
â”‚                                                                         â”‚
â”‚  ç°åœ¨å¯ä»¥ï¼š                                                              â”‚
â”‚  - scene.getMethod("@extendedDummyMain") è·å–è¿™ä¸ªæ–¹æ³•                   â”‚
â”‚  - dummyMain.getCfg() è·å–æ§åˆ¶æµå›¾                                      â”‚
â”‚  - ç”¨äºåç»­çš„æ±¡ç‚¹åˆ†æã€æ•°æ®æµåˆ†æç­‰                                       â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. ç±»ä¸å‡½æ•°è¯¦è§£

### 6.1 æšä¸¾ç±»å‹

| æšä¸¾ | ç”¨é€” | å€¼ç¤ºä¾‹ |
|------|------|--------|
| `AbilityLifecycleStage` | Ability ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ | `CREATE`, `FOREGROUND`, `DESTROY` |
| `ComponentLifecycleStage` | Component ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ | `ABOUT_TO_APPEAR`, `BUILD` |
| `UIEventType` | UI äº‹ä»¶ç±»å‹ | `ON_CLICK`, `ON_TOUCH` |
| `NavigationType` | é¡µé¢è·³è½¬ç±»å‹ | `START_ABILITY`, `ROUTER_PUSH` |

### 6.2 æ¥å£ç±»å‹

#### AbilityInfo

```typescript
interface AbilityInfo {
    arkClass: ArkClass;        // åŸå§‹ç±»å¼•ç”¨
    signature: ClassSignature; // ç±»ç­¾åï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰
    name: string;              // ç±»å
    lifecycleMethods: Map;     // ç”Ÿå‘½å‘¨æœŸæ–¹æ³•é›†åˆ
    components: ComponentInfo[];// å…³è”çš„ UI ç»„ä»¶
    navigationTargets: [];     // å¯è·³è½¬çš„ç›®æ ‡
    isEntry: boolean;          // æ˜¯å¦æ˜¯å¯åŠ¨å…¥å£
}
```

#### ComponentInfo

```typescript
interface ComponentInfo {
    arkClass: ArkClass;
    signature: ClassSignature;
    name: string;
    lifecycleMethods: Map;     // aboutToAppear, build ç­‰
    uiCallbacks: UICallbackInfo[]; // ä» ViewTree æå–çš„å›è°ƒ
    isEntry: boolean;          // æ˜¯å¦æœ‰ @Entry è£…é¥°å™¨
}
```

#### UICallbackInfo

```typescript
interface UICallbackInfo {
    componentType: string;     // "Button", "Text", "Image"
    eventType: UIEventType;    // ON_CLICK, ON_TOUCH
    callbackMethod: ArkMethod; // å®é™…çš„å›è°ƒå‡½æ•°
    relatedStateValues: [];    // ä¾èµ–çš„ @State å˜é‡
    viewTreeNode?: ViewTreeNode; // ViewTree èŠ‚ç‚¹å¼•ç”¨
}
```

### 6.3 æ ¸å¿ƒç±»

#### AbilityCollector

| æ–¹æ³• | å‚æ•° | è¿”å›å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `constructor` | `scene: Scene` | - | åˆå§‹åŒ–æ”¶é›†å™¨ |
| `collectAllAbilities` | - | `AbilityInfo[]` | æ”¶é›†æ‰€æœ‰ Ability |
| `collectAllComponents` | - | `ComponentInfo[]` | æ”¶é›†æ‰€æœ‰ Component |
| `getEntryAbility` | - | `AbilityInfo \| null` | è·å–å…¥å£ Ability |
| `getAbilityBySignature` | `ClassSignature` | `AbilityInfo \| undefined` | æŒ‰ç­¾åæŸ¥æ‰¾ |

#### ViewTreeCallbackExtractor

| æ–¹æ³• | å‚æ•° | è¿”å›å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `constructor` | `scene: Scene` | - | åˆå§‹åŒ–æå–å™¨ |
| `extractFromComponent` | `ArkClass` | `UICallbackInfo[]` | æå–å•ä¸ªç»„ä»¶çš„å›è°ƒ |
| `fillComponentCallbacks` | `ComponentInfo` | `void` | å¡«å……ç»„ä»¶çš„å›è°ƒä¿¡æ¯ |
| `fillAllComponentCallbacks` | `ComponentInfo[]` | `void` | æ‰¹é‡å¡«å…… |

#### LifecycleModelCreator

| æ–¹æ³• | å‚æ•° | è¿”å›å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `constructor` | `scene, config?` | - | åˆå§‹åŒ–åˆ›å»ºå™¨ |
| `create` | - | `void` | **ä¸»å…¥å£**ï¼Œæ‰§è¡Œå®Œæ•´æ„å»º |
| `getDummyMain` | - | `ArkMethod` | è·å–ç”Ÿæˆçš„ DummyMain |
| `getAbilities` | - | `AbilityInfo[]` | è·å–æ”¶é›†åˆ°çš„ Ability |
| `getComponents` | - | `ComponentInfo[]` | è·å–æ”¶é›†åˆ°çš„ Component |

---

## 7. ä½¿ç”¨ç¤ºä¾‹

### 7.1 åŸºæœ¬ä½¿ç”¨

```typescript
import { Scene } from '../Scene';
import { LifecycleModelCreator } from './TEST_lifecycle';

// 1. æ„å»º Sceneï¼ˆå·²æœ‰ä»£ç ï¼‰
const scene = new Scene();
scene.buildSceneFromProjectDir('/path/to/project');

// 2. åˆ›å»ºæ‰©å±•ç‰ˆ DummyMain
const creator = new LifecycleModelCreator(scene);
creator.create();

// 3. è·å–ç»“æœ
const dummyMain = creator.getDummyMain();
console.log('DummyMain ç­¾å:', dummyMain.getSignature().toString());
console.log('CFG å—æ•°é‡:', dummyMain.getCfg()?.getBlocks().length);
```

### 7.2 è‡ªå®šä¹‰é…ç½®

```typescript
const creator = new LifecycleModelCreator(scene, {
    // ç¦ç”¨å¤š Ability è·³è½¬å»ºæ¨¡
    enableMultiAbilityNavigation: false,
    
    // å¯ç”¨ç²¾ç»†åŒ– UI å›è°ƒ
    enableFineGrainedUICallbacks: true,
    
    // è‡ªå®šä¹‰ç”Ÿå‘½å‘¨æœŸé¡ºåº
    lifecycleOrder: [
        AbilityLifecycleStage.CREATE,
        AbilityLifecycleStage.FOREGROUND,
        // è·³è¿‡å…¶ä»–é˜¶æ®µ
    ],
    
    // æœ€å¤§è·³è½¬æ·±åº¦
    maxNavigationDepth: 5,
});
```

### 7.3 å•ç‹¬ä½¿ç”¨æ”¶é›†å™¨

```typescript
import { AbilityCollector, ViewTreeCallbackExtractor } from './TEST_lifecycle';

// åªæ”¶é›†ä¿¡æ¯ï¼Œä¸æ„å»º DummyMain
const collector = new AbilityCollector(scene);
const abilities = collector.collectAllAbilities();
const components = collector.collectAllComponents();

// æ‰“å°ç»“æœ
console.log('æ‰¾åˆ°çš„ Ability:');
for (const ability of abilities) {
    console.log(`  - ${ability.name}`);
    for (const [stage, method] of ability.lifecycleMethods) {
        console.log(`      ${stage}: ${method.getName()}`);
    }
}

// å•ç‹¬æå–å›è°ƒ
const extractor = new ViewTreeCallbackExtractor(scene);
for (const component of components) {
    const callbacks = extractor.extractFromComponent(component.arkClass);
    console.log(`${component.name} çš„ UI å›è°ƒ:`, callbacks.length);
}
```

---

## 8. TODO ä¸æ‰©å±•ç‚¹

### 8.1 å·²å®ŒæˆåŠŸèƒ½ âœ…

| ä½ç½® | åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|------|------|--------|------|
| `NavigationAnalyzer.ts` | è·¯ç”±åˆ†æå™¨ | âœ… å®Œæˆ | æ–°å¢æ¨¡å—ï¼Œä¸“é—¨å¤„ç†è·¯ç”±åˆ†æ |
| `AbilityCollector.analyzeNavigationTargets()` | è·³è½¬åˆ†æ | âœ… å®Œæˆ | è§£æ loadContent/pushUrl/startAbility |
| `NavigationAnalyzer.extractRouterUrl()` | å¯¹è±¡å‚æ•°è§£æ | âœ… å®Œæˆ | æ”¯æŒè¿½è¸ªå˜é‡å®šä¹‰å’Œå­—æ®µèµ‹å€¼ |
| `NavigationAnalyzer.extractWantTarget()` | Want å¯¹è±¡è§£æ | âœ… å®Œæˆ | è§£æ abilityName å­—æ®µ |
| `AbilityCollector.checkIsEntryAbility()` | å…¥å£è¯†åˆ« | âœ… å®Œæˆ | è¯»å– module.json5 çš„ mainElement |
| `ViewTreeCallbackExtractor.resolveCallbackMethod()` | å›è°ƒæ–¹æ³•è§£æ | âœ… å®Œæˆ | æ”¯æŒ MethodSignature/FieldRef/Constant |
| `LifecycleModelCreator.addMethodInvocation()` | å‚æ•°ç”Ÿæˆ | âœ… å®Œæˆ | è‡ªåŠ¨ç”Ÿæˆ Want, WindowStage ç­‰å‚æ•°å¯¹è±¡ |

### 8.2 å¾…å®ç°åŠŸèƒ½

| ä½ç½® | åŠŸèƒ½ | ä¼˜å…ˆçº§ | è¯´æ˜ |
|------|------|--------|------|
| `LifecycleModelCreator.addUICallbackInvocation()` | æ§ä»¶å®ä¾‹åŒ– | ä½ | ä¸ºæ¯ä¸ªæ§ä»¶åˆ›å»ºå®ä¾‹ï¼ˆå½“å‰ç®€åŒ–ç‰ˆå¯ç”¨ï¼‰ |
| `resolveCallbackMethod()` Lambda å¢å¼º | Lambda å®Œæ•´æ”¯æŒ | ä½ | å®Œæ•´è§£æå†…è” Lambda è¡¨è¾¾å¼ |
| è·¯ç”±å‚æ•°æ•°æ®æµåˆ†æ | å¤æ‚å‚æ•°è§£æ | ä½ | å¤„ç†åŠ¨æ€è®¡ç®—çš„è·¯ç”±å‚æ•° |

### 8.3 æ‰©å±•å»ºè®®

#### æ·»åŠ æ–°çš„ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ

```typescript
// åœ¨ LifecycleTypes.ts ä¸­æ·»åŠ 
enum AbilityLifecycleStage {
    // ... ç°æœ‰é˜¶æ®µ
    ON_NEW_WANT = 'onNewWant',  // æ–°å¢
}

// åœ¨ AbilityCollector.ts ä¸­å¤„ç†
case 'onNewWant':
    methods.set(AbilityLifecycleStage.ON_NEW_WANT, method);
    break;
```

#### æ·»åŠ æ–°çš„ UI äº‹ä»¶ç±»å‹

```typescript
// åœ¨ LifecycleTypes.ts ä¸­æ·»åŠ 
enum UIEventType {
    // ... ç°æœ‰ç±»å‹
    ON_SCROLL = 'onScroll',  // æ–°å¢
}

// åœ¨ ViewTreeCallbackExtractor.ts ä¸­æ·»åŠ æ˜ å°„
const METHOD_TO_EVENT_TYPE = new Map([
    // ... ç°æœ‰æ˜ å°„
    ['onScroll', UIEventType.ON_SCROLL],
]);
```

---

## 9. å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆéœ€è¦ while(true) å¾ªç¯ï¼Ÿ

**ç­”**ï¼šå› ä¸ºåœ¨å®é™…åº”ç”¨ä¸­ï¼Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„è°ƒç”¨é¡ºåºæ˜¯**éç¡®å®šæ€§**çš„ã€‚ç”¨æˆ·å¯èƒ½ï¼š
- æŒ‰ Home é”®ï¼ˆè§¦å‘ onBackgroundï¼‰
- å†æ‰“å¼€åº”ç”¨ï¼ˆè§¦å‘ onForegroundï¼‰
- ç‚¹å‡»æŒ‰é’®ï¼ˆè§¦å‘ onClickï¼‰
- ...

`while(true)` + `if (count == N)` çš„ç»“æ„æ¨¡æ‹Ÿäº†è¿™ç§éç¡®å®šæ€§ï¼Œè®©æ¯ä¸ªåˆ†æ”¯éƒ½**å¯èƒ½**è¢«æ‰§è¡Œã€‚

### Q2: è¿™ä¸ªæ¨¡å—å’ŒåŸç‰ˆ DummyMainCreater å†²çªå—ï¼Ÿ

**ç­”**ï¼šä¸å†²çªã€‚ä¸¤è€…æ˜¯ç‹¬ç«‹çš„ï¼š
- åŸç‰ˆç”Ÿæˆ `@dummyMain`
- æœ¬æ¨¡å—ç”Ÿæˆ `@extendedDummyMain`

å¯ä»¥åŒæ—¶ä½¿ç”¨ï¼Œæˆ–è€…ç”¨æœ¬æ¨¡å—å®Œå…¨æ›¿ä»£åŸç‰ˆã€‚

### Q3: ç”Ÿæˆçš„ DummyMain å¦‚ä½•ç”¨äºæ±¡ç‚¹åˆ†æï¼Ÿ

**ç­”**ï¼š
```typescript
// 1. æ„å»º DummyMain
const creator = new LifecycleModelCreator(scene);
creator.create();
const dummyMain = creator.getDummyMain();

// 2. è·å– CFG
const cfg = dummyMain.getCfg();

// 3. ç”¨äº IFDS åˆ†æ
const problem = new TaintAnalysisProblem(source, sink);
const solver = new IFDSSolver(cfg, problem);
solver.solve();
```

### Q4: ViewTree æ˜¯ä»€ä¹ˆæ—¶å€™æ„å»ºçš„ï¼Ÿ

**ç­”**ï¼šViewTree æ˜¯åœ¨ ArkAnalyzer æ„å»º Scene æ—¶è‡ªåŠ¨ç”Ÿæˆçš„ã€‚å¯¹äºæœ‰ `build()` æ–¹æ³•çš„ `@Component` ç±»ï¼ŒArkAnalyzer ä¼šè§£æå…¶ UI ç»“æ„å¹¶ç”Ÿæˆ ViewTreeã€‚

æˆ‘ä»¬çš„æ¨¡å—åªæ˜¯**è¯»å–**è¿™ä¸ªå·²æœ‰çš„ ViewTreeï¼Œæå–å…¶ä¸­çš„å›è°ƒä¿¡æ¯ã€‚

---

## ğŸ“ é™„å½•

### A. å‚è€ƒèµ„æ–™

- åŸç‰ˆ DummyMainCreater: `src/core/common/DummyMainCreater.ts`
- ViewTree å®ç°: `src/core/graph/ViewTree.ts`
- ViewTree æ„å»ºå™¨: `src/core/graph/builder/ViewTreeBuilder.ts`
- å…¥å£æ–¹æ³•å·¥å…·: `src/utils/entryMethodUtils.ts`

### B. ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | è¯´æ˜ |
|------|------|------|
| 0.1.0 | 2025-01-17 | åˆå§‹æ¡†æ¶ï¼ŒåŸºæœ¬ç»“æ„å®Œæˆ |
| 0.2.0 | 2025-01-27 | æ–°å¢ NavigationAnalyzer è·¯ç”±åˆ†æå™¨ |
| 0.3.0 | 2025-01-27 | å®Œå–„è·¯ç”±å‚æ•°è§£æå’Œ module.json5 å…¥å£è¯†åˆ« |
| 0.4.0 | 2025-01-27 | å®ç° resolveCallbackMethod() å›è°ƒæ–¹æ³•è§£æ |
| 0.5.0 | 2025-01-27 | å®ç° addMethodInvocation() ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å‚æ•°ç”Ÿæˆ |

---

> **ä½œè€…**: AI Assistant &  YiZhou
> **åˆ›å»ºæ—¥æœŸ**: 2025-01-17  
> **æœ€åæ›´æ–°**: 2025-01-27
